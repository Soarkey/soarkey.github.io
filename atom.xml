<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Soarkey的博客</title>
  <subtitle>Stay hungry. Stay foolish.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://soarkey.github.io/"/>
  <updated>2017-08-29T13:22:55.450Z</updated>
  <id>https://soarkey.github.io/</id>
  
  <author>
    <name>Soarkey</name>
    <email>985686485@qq.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Java三种代理模式：静态代理、动态代理和cglib代理</title>
    <link href="https://soarkey.github.io/2017/07/19/Java%E4%B8%89%E7%A7%8D%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%EF%BC%9A%E9%9D%99%E6%80%81%E4%BB%A3%E7%90%86%E3%80%81%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%E5%92%8Ccglib%E4%BB%A3%E7%90%86/"/>
    <id>https://soarkey.github.io/2017/07/19/Java三种代理模式：静态代理、动态代理和cglib代理/</id>
    <published>2017-07-19T00:00:00.000Z</published>
    <updated>2017-08-29T13:22:55.450Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一、代理模式介绍"><a href="#一、代理模式介绍" class="headerlink" title="一、代理模式介绍"></a>一、代理模式介绍</h1><p><a href="https://zh.wikipedia.org/wiki/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F" target="_blank" rel="external">代理模式</a>是一种设计模式，提供了对目标对象额外的访问方式，即通过代理对象访问目标对象，这样可以在不修改原目标对象的前提下，提供额外的功能操作，扩展目标对象的功能。</p>
<p>简言之，代理模式就是设置一个中间代理来控制访问原目标对象，以达到增强原对象的功能和简化访问方式。</p>
<blockquote>
<p>代理模式UML类图</p>
</blockquote>
<p><img src="https://static.oschina.net/uploads/img/201707/18202945_lHIa.png" alt="代理模式UML类图" title="代理模式UML类图"></p>
<p>举个例子，我们生活中经常到火车站去买车票，但是人一多的话，就会非常拥挤，于是就有了代售点，我们能从代售点买车票了。这其中就是代理模式的体现，代售点代理了火车站对象，提供购买车票的方法。</p>
<h1 id="二、静态代理"><a href="#二、静态代理" class="headerlink" title="二、静态代理"></a>二、静态代理</h1><p>这种代理方式需要代理对象和目标对象实现一样的接口。</p>
<p>优点：可以在不修改目标对象的前提下扩展目标对象的功能。</p>
<p>缺点：</p>
<ol>
<li>冗余。由于代理对象要实现与目标对象一致的接口，会产生过多的代理类。</li>
<li>不易维护。一旦接口增加方法，目标对象与代理对象都要进行修改。</li>
</ol>
<blockquote>
<p>举例：保存用户功能的静态代理实现</p>
</blockquote>
<ul>
<li>接口类： IUserDao</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.proxy;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserDao</span> </span>&#123;</div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>目标对象：UserDao</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.proxy;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao</span> <span class="keyword">implements</span> <span class="title">IUserDao</span></span>&#123;</div><div class="line"></div><div class="line">true<span class="meta">@Override</span></div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</div><div class="line">truetrueSystem.out.println(<span class="string">"保存数据"</span>);</div><div class="line">true&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>静态代理对象：UserDapProxy   <strong><em>需要实现IUserDao接口！</em></strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.proxy;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoProxy</span> <span class="keyword">implements</span> <span class="title">IUserDao</span></span>&#123;</div><div class="line"></div><div class="line">true<span class="keyword">private</span> IUserDao target;</div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="title">UserDaoProxy</span><span class="params">(IUserDao target)</span> </span>&#123;</div><div class="line">truetrue<span class="keyword">this</span>.target = target;</div><div class="line">true&#125;</div><div class="line">true</div><div class="line">true<span class="meta">@Override</span></div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</div><div class="line">truetrueSystem.out.println(<span class="string">"开启事务"</span>);<span class="comment">//扩展了额外功能</span></div><div class="line">truetruetarget.save();</div><div class="line">truetrueSystem.out.println(<span class="string">"提交事务"</span>);</div><div class="line">true&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>测试类：TestProxy</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.proxy;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.junit.Test;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StaticUserProxy</span> </span>&#123;</div><div class="line">true<span class="meta">@Test</span></div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testStaticProxy</span><span class="params">()</span></span>&#123;</div><div class="line">truetrue<span class="comment">//目标对象</span></div><div class="line">truetrueIUserDao target = <span class="keyword">new</span> UserDao();</div><div class="line">truetrue<span class="comment">//代理对象</span></div><div class="line">truetrueUserDaoProxy proxy = <span class="keyword">new</span> UserDaoProxy(target);</div><div class="line">truetrueproxy.save();</div><div class="line">true&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>输出结果</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">开启事务</div><div class="line">保存数据</div><div class="line">提交事务</div></pre></td></tr></table></figure>
<h1 id="三、动态代理"><a href="#三、动态代理" class="headerlink" title="三、动态代理"></a>三、动态代理</h1><p>动态代理利用了<a href="http://tool.oschina.net/uploads/apidocs/jdk-zh/" target="_blank" rel="external">JDK API</a>，动态地在内存中构建代理对象，从而实现对目标对象的代理功能。动态代理又被称为JDK代理或接口代理。</p>
<p>静态代理与动态代理的区别主要在：</p>
<ul>
<li>静态代理在编译时就已经实现，编译完成后代理类是一个实际的class文件</li>
<li>动态代理是在运行时动态生成的，即编译完成后没有实际的class文件，而是在运行时动态生成类字节码，并加载到JVM中</li>
</ul>
<p><strong>特点：</strong><br>动态代理对象不需要实现接口，但是要求目标对象必须实现接口，否则不能使用动态代理。</p>
<p>JDK中生成代理对象主要涉及的类有</p>
<ul>
<li><a href="http://tool.oschina.net/uploads/apidocs/jdk-zh/java/lang/reflect/Proxy.html" target="_blank" rel="external">java.lang.reflect Proxy</a>，主要方法为<figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="keyword">Object</span>	newProxyInstance(ClassLoader loader,  <span class="comment">//指定当前目标对象使用类加载器</span></div><div class="line"></div><div class="line"> <span class="keyword">Class</span>&lt;?&gt;[] interfaces,    <span class="comment">//目标对象实现的接口的类型</span></div><div class="line"> InvocationHandler h      <span class="comment">//事件处理器</span></div><div class="line">) </div><div class="line"><span class="comment">//返回一个指定接口的代理类实例，该接口可以将方法调用指派到指定的调用处理程序。</span></div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><a href="http://tool.oschina.net/uploads/apidocs/jdk-zh/java/lang/reflect/InvocationHandler.html" target="_blank" rel="external">java.lang.reflect  InvocationHandler</a>，主要方法为<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"> <span class="function">Object	<span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> </span></div><div class="line"><span class="comment">// 在代理实例上处理方法调用并返回结果。</span></div></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>举例：保存用户功能的动态代理实现</p>
</blockquote>
<ul>
<li>接口类： IUserDao</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.proxy;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserDao</span> </span>&#123;</div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>目标对象：UserDao</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.proxy;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao</span> <span class="keyword">implements</span> <span class="title">IUserDao</span></span>&#123;</div><div class="line"></div><div class="line">true<span class="meta">@Override</span></div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</div><div class="line">truetrueSystem.out.println(<span class="string">"保存数据"</span>);</div><div class="line">true&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>动态代理对象：UserProxyFactory </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.proxy;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</div><div class="line"><span class="keyword">import</span> java.lang.reflect.Method;</div><div class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyFactory</span> </span>&#123;</div><div class="line"></div><div class="line">true<span class="keyword">private</span> Object target;<span class="comment">// 维护一个目标对象</span></div><div class="line"></div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="title">ProxyFactory</span><span class="params">(Object target)</span> </span>&#123;</div><div class="line">truetrue<span class="keyword">this</span>.target = target;</div><div class="line">true&#125;</div><div class="line"></div><div class="line">true<span class="comment">// 为目标对象生成代理对象</span></div><div class="line">true<span class="function"><span class="keyword">public</span> Object <span class="title">getProxyInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">truetrue<span class="keyword">return</span> Proxy.newProxyInstance(target.getClass().getClassLoader(), target.getClass().getInterfaces(),</div><div class="line">truetruetruetrue<span class="keyword">new</span> InvocationHandler() &#123;</div><div class="line"></div><div class="line">truetruetruetruetrue<span class="meta">@Override</span></div><div class="line">truetruetruetruetrue<span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">truetruetruetruetruetrueSystem.out.println(<span class="string">"开启事务"</span>);</div><div class="line"></div><div class="line">truetruetruetruetruetrue<span class="comment">// 执行目标对象方法</span></div><div class="line">truetruetruetruetruetrueObject returnValue = method.invoke(target, args);</div><div class="line"></div><div class="line">truetruetruetruetruetrueSystem.out.println(<span class="string">"提交事务"</span>);</div><div class="line">truetruetruetruetruetrue<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">truetruetruetruetrue&#125;</div><div class="line">truetruetruetrue&#125;);</div><div class="line">true&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>测试类：TestProxy </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.proxy;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.junit.Test;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestProxy</span> </span>&#123;</div><div class="line"></div><div class="line">true<span class="meta">@Test</span></div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDynamicProxy</span> <span class="params">()</span></span>&#123;</div><div class="line">truetrueIUserDao target = <span class="keyword">new</span> UserDao();</div><div class="line">truetrueSystem.out.println(target.getClass());  <span class="comment">//输出目标对象信息</span></div><div class="line">truetrueIUserDao proxy = (IUserDao) <span class="keyword">new</span> ProxyFactory(target).getProxyInstance();</div><div class="line">truetrueSystem.out.println(proxy.getClass());  <span class="comment">//输出代理对象信息</span></div><div class="line">truetrueproxy.save();  <span class="comment">//执行代理方法</span></div><div class="line">true&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>输出结果</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">class com.proxy.UserDao</div><div class="line">class com.sun.proxy.<span class="variable">$Proxy4</span></div><div class="line">开启事务</div><div class="line">保存数据</div><div class="line">提交事务</div></pre></td></tr></table></figure>
<h1 id="四、cglib代理"><a href="#四、cglib代理" class="headerlink" title="四、cglib代理"></a>四、cglib代理</h1><blockquote>
<p>cglib is a powerful, high performance and quality Code Generation Library. It can extend JAVA classes and implement interfaces at runtime.</p>
</blockquote>
<p><a href="https://github.com/cglib/cglib" target="_blank" rel="external">cglib</a>   (Code Generation Library )是一个第三方代码生成类库，运行时在内存中动态生成一个子类对象从而实现对目标对象功能的扩展。</p>
<p><strong>cglib特点</strong></p>
<ul>
<li>JDK的动态代理有一个限制，就是使用动态代理的对象必须实现一个或多个接口。<br>如果想代理没有实现接口的类，就可以使用CGLIB实现。 </li>
<li>CGLIB是一个强大的高性能的代码生成包，它可以在运行期扩展Java类与实现Java接口。<br>它广泛的被许多AOP的框架使用，例如Spring AOP和dynaop，为他们提供方法的interception（拦截）。 </li>
<li>CGLIB包的底层是通过使用一个小而快的字节码处理框架ASM，来转换字节码并生成新的类。<br>不鼓励直接使用ASM，因为它需要你对JVM内部结构包括class文件的格式和指令集都很熟悉。</li>
</ul>
<p>cglib与动态代理最大的<strong>区别</strong>就是</p>
<ul>
<li>使用动态代理的对象必须实现一个或多个接口</li>
<li>使用cglib代理的对象则无需实现接口，达到代理类无侵入。</li>
</ul>
<p>使用cglib需要引入<a href="https://repo1.maven.org/maven2/cglib/cglib/3.2.5/cglib-3.2.5.jar" target="_blank" rel="external">cglib的jar包</a>，如果你已经有spring-core的jar包，则无需引入，因为spring中包含了cglib。</p>
<ul>
<li>cglib的Maven坐标<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cglib<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cglib<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>举例：保存用户功能的动态代理实现</p>
</blockquote>
<ul>
<li>目标对象：UserDao</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.cglib;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao</span></span>&#123;</div><div class="line"></div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</div><div class="line">truetrueSystem.out.println(<span class="string">"保存数据"</span>);</div><div class="line">true&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>代理对象：ProxyFactory</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.cglib;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.lang.reflect.Method;</div><div class="line"></div><div class="line"><span class="keyword">import</span> net.sf.cglib.proxy.Enhancer;</div><div class="line"><span class="keyword">import</span> net.sf.cglib.proxy.MethodInterceptor;</div><div class="line"><span class="keyword">import</span> net.sf.cglib.proxy.MethodProxy;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyFactory</span> <span class="keyword">implements</span> <span class="title">MethodInterceptor</span></span>&#123;</div><div class="line"></div><div class="line">true<span class="keyword">private</span> Object target;<span class="comment">//维护一个目标对象</span></div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="title">ProxyFactory</span><span class="params">(Object target)</span> </span>&#123;</div><div class="line">truetrue<span class="keyword">this</span>.target = target;</div><div class="line">true&#125;</div><div class="line">true</div><div class="line">true<span class="comment">//为目标对象生成代理对象</span></div><div class="line">true<span class="function"><span class="keyword">public</span> Object <span class="title">getProxyInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">truetrue<span class="comment">//工具类</span></div><div class="line">truetrueEnhancer en = <span class="keyword">new</span> Enhancer();</div><div class="line">truetrue<span class="comment">//设置父类</span></div><div class="line">truetrueen.setSuperclass(target.getClass());</div><div class="line">truetrue<span class="comment">//设置回调函数</span></div><div class="line">truetrueen.setCallback(<span class="keyword">this</span>);</div><div class="line">truetrue<span class="comment">//创建子类对象代理</span></div><div class="line">truetrue<span class="keyword">return</span> en.create();</div><div class="line">true&#125;</div><div class="line"></div><div class="line">true<span class="meta">@Override</span></div><div class="line">true<span class="function"><span class="keyword">public</span> Object <span class="title">intercept</span><span class="params">(Object obj, Method method, Object[] args, MethodProxy proxy)</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">truetrueSystem.out.println(<span class="string">"开启事务"</span>);</div><div class="line">truetrue<span class="comment">// 执行目标对象的方法</span></div><div class="line">truetrueObject returnValue = method.invoke(target, args);</div><div class="line">truetrueSystem.out.println(<span class="string">"关闭事务"</span>);</div><div class="line">truetrue<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">true&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>测试类：TestProxy </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.cglib;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.junit.Test;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestProxy</span> </span>&#123;</div><div class="line"></div><div class="line">true<span class="meta">@Test</span></div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCglibProxy</span><span class="params">()</span></span>&#123;</div><div class="line">truetrue<span class="comment">//目标对象</span></div><div class="line">truetrueUserDao target = <span class="keyword">new</span> UserDao();</div><div class="line">truetrueSystem.out.println(target.getClass());</div><div class="line">truetrue<span class="comment">//代理对象</span></div><div class="line">truetrueUserDao proxy = (UserDao) <span class="keyword">new</span> ProxyFactory(target).getProxyInstance();</div><div class="line">truetrueSystem.out.println(proxy.getClass());</div><div class="line">truetrue<span class="comment">//执行代理对象方法</span></div><div class="line">truetrueproxy.save();</div><div class="line">true&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>输出结果</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">class com.cglib.UserDao</div><div class="line">class com.cglib.UserDao$<span class="variable">$EnhancerByCGLIB</span>$<span class="variable">$552188b6</span></div><div class="line">开启事务</div><div class="line">保存数据</div><div class="line">关闭事务</div></pre></td></tr></table></figure>
<h1 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h1><ol>
<li><p>静态代理实现较简单，只要代理对象对目标对象进行包装，即可实现增强功能，但静态代理只能为一个目标对象服务，如果目标对象过多，则会产生很多代理类。</p>
</li>
<li><p>JDK动态代理需要目标对象实现业务接口，代理类只需实现InvocationHandler接口。</p>
</li>
<li><p>动态代理生成的类为 lass com.sun.proxy.$Proxy4，cglib代理生成的类为class com.cglib.UserDao$$EnhancerByCGLIB$$552188b6。</p>
</li>
<li><p>静态代理在编译时产生class字节码文件，可以直接使用，效率高。</p>
</li>
<li><p>动态代理必须实现InvocationHandler接口，通过反射代理方法，比较消耗系统性能，但可以减少代理类的数量，使用更灵活。</p>
</li>
<li><p>cglib代理无需实现接口，通过生成类字节码实现代理，比反射稍快，不存在性能问题，但cglib会继承目标对象，需要重写方法，所以目标对象不能为final类。</p>
</li>
</ol>
<h1 id="六、相关资料"><a href="#六、相关资料" class="headerlink" title="六、相关资料"></a>六、相关资料</h1><p>代理模式相关知识</p>
<ul>
<li><a href="http://www.jianshu.com/p/6f6bb2f0ece9" target="_blank" rel="external">代理模式及Java实现动态代理</a></li>
<li><a href="http://blog.csdn.net/chenssy/article/details/11179815" target="_blank" rel="external">设计模式读书笔记 - 代理模式</a></li>
<li><a href="http://rejoy.iteye.com/blog/1627405" target="_blank" rel="external">JDK动态代理实现原理</a></li>
<li><a href="https://www.ibm.com/developerworks/cn/java/j-lo-proxy1/" target="_blank" rel="external">Java 动态代理机制分析及扩展</a></li>
<li><a href="http://www.cnblogs.com/fillPv/p/5939277.html" target="_blank" rel="external">Java代理(jdk静态代理、动态代理和cglib动态代理)</a></li>
<li><a href="http://blog.csdn.net/dreamrealised/article/details/12885739" target="_blank" rel="external">AOP的底层实现-CGLIB动态代理和JDK动态代理</a></li>
<li><a href="http://llying.iteye.com/blog/220452" target="_blank" rel="external">深入浅出CGlib-打造无入侵的类代理</a></li>
<li><a href="https://www.ibm.com/developerworks/cn/java/j-lo-springaopcglib/" target="_blank" rel="external">Spring AOP 实现原理与 CGLIB 应用</a></li>
</ul>
<p>UML相关知识</p>
<ul>
<li><a href="https://yq.aliyun.com/articles/75556" target="_blank" rel="external">博客 - UML类图与类的关系详解</a></li>
<li><a href="https://books.google.com.hk/books?id=dU--JuYudxgC&amp;pg=PA18&amp;lpg=PA18&amp;dq=uml%E8%AF%A6%E8%A7%A3&amp;source=bl&amp;ots=ay5tHhDK0l&amp;sig=_Fj_cEmG9ZSN5S3HHl1SrNcmcKw&amp;hl=zh-CN&amp;sa=X&amp;ved=0ahUKEwiR14Kg45LVAhXL44MKHRZHD3Y4ChDoAQg3MAQ#v=onepage&amp;q=uml%E8%AF%A6%E8%A7%A3&amp;f=false" target="_blank" rel="external">goole图书 -《UML建模实例详解》</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;一、代理模式介绍&quot;&gt;&lt;a href=&quot;#一、代理模式介绍&quot; class=&quot;headerlink&quot; title=&quot;一、代理模式介绍&quot;&gt;&lt;/a&gt;一、代理模式介绍&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E4%BB%
    
    </summary>
    
      <category term="java" scheme="https://soarkey.github.io/categories/java/"/>
    
    
      <category term="代理模式" scheme="https://soarkey.github.io/tags/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>Maven小试牛刀【1】</title>
    <link href="https://soarkey.github.io/2017/07/17/Maven%E5%B0%8F%E8%AF%95%E7%89%9B%E5%88%80%E3%80%901%E3%80%91/"/>
    <id>https://soarkey.github.io/2017/07/17/Maven小试牛刀【1】/</id>
    <published>2017-07-17T00:00:00.000Z</published>
    <updated>2017-08-29T13:07:47.910Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一、Maven简介"><a href="#一、Maven简介" class="headerlink" title="一、Maven简介"></a>一、Maven简介</h1><p>一个软件构建的生命周期有：<br>清除–&gt; 编译–&gt;测试–&gt;报告–&gt;打包–&gt;安装–&gt;部署</p>
<p>Apache Maven，就是一个一个采用纯Java编写的软件项目管理及自动构建工具，由Apache软件基金会所提供。基于项目对象模型（缩写：POM）概念，Maven利用一个中央信息片断（pom.xml）能管理一个项目的构建、报告和文档等步骤。</p>
<p>Maven也可被用于构建和管理各种项目，例如C#，Ruby，Scala和其他语言编写的项目。Maven曾是Jakarta项目的子项目，现为由Apache软件基金会主持的独立Apache项目。</p>
<h1 id="二、下载Maven"><a href="#二、下载Maven" class="headerlink" title="二、下载Maven"></a>二、下载Maven</h1><p><a href="https://maven.apache.org/" target="_blank" rel="external">Maven官网</a></p>
<p><a href="https://maven.apache.org/download.cgi" target="_blank" rel="external"><img src="https://static.oschina.net/uploads/img/201707/17100454_yqRt.jpg" alt="下载Maven"></a></p>
<p>如果速度较慢的话，可以尝试在CSDN下载，这里提供Maven3.5.0的链接<br><a href="http://download.csdn.net/detail/qq_33931248/9900811" target="_blank" rel="external">Maven3.5.0</a></p>
<p>下载之后直接将Maven解压到文件夹即可。</p>
<h1 id="三、配置Maven"><a href="#三、配置Maven" class="headerlink" title="三、配置Maven"></a>三、配置Maven</h1><p>Maven的运行需要依赖JDK，所以先要确认你是否成功安装了JDK，打开cmd，输入java -version<br>出现以下结果说明配置正确。<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">C:\Users\XXX&gt;<span class="keyword">java </span>-version</div><div class="line"><span class="keyword">java </span>version <span class="string">"1.8.0_121"</span></div><div class="line"><span class="keyword">Java(TM) </span>SE Runtime Environment (<span class="keyword">build </span><span class="number">1</span>.<span class="number">8</span>.<span class="number">0</span>_121-<span class="keyword">b13)</span></div><div class="line"><span class="keyword">Java </span>HotSpot(TM) <span class="number">64</span>-<span class="keyword">Bit </span>Server VM (<span class="keyword">build </span><span class="number">25</span>.<span class="number">121</span>-<span class="keyword">b13, </span>mixed mode)</div></pre></td></tr></table></figure></p>
<p>如果没有安装JDK，可以参照这篇文章进行安装配置：<a href="http://jingyan.baidu.com/article/6dad5075d1dc40a123e36ea3.html" target="_blank" rel="external">JDK安装与配置</a></p>
<p>接下来进行Maven的配置，<br>打开控制面板-&gt;系统-&gt;高级系统设置-&gt;环境变量，<br>在系统变量处加入以下环境变量<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="attr">M2_HOME</span>=你的Maven安装路径</div><div class="line"><span class="attr">M2</span>=%M2_HOME%\bin</div><div class="line"><span class="attr">MAVEN_OPTS</span>=-Xms256m -Xmx512m</div></pre></td></tr></table></figure></p>
<p>之后在系统变量Path的末尾加入  ;%M2%  即可。</p>
<p>以上只针对Windows，其他系统可以参照这篇文档：<br><a href="http://wiki.jikexueyuan.com/project/maven/environment-setup.html" target="_blank" rel="external">极客学院-wiki-Maven环境变量配置</a></p>
<h1 id="四、运行Maven"><a href="#四、运行Maven" class="headerlink" title="四、运行Maven"></a>四、运行Maven</h1><p>打开cmd，输入mvn -v，如果出现下面的结果，说明已经安装成功了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">C:\Users\XXX&gt;mvn -v</div><div class="line">Apache Maven 3.5.0 (ff8f5e7444045639af65f6095c62210b5713f426; 2017-04-04T03:39:06+08:00)</div><div class="line">Maven home: C:\Program Files\apache-maven-3.5.0\bin\..</div><div class="line">Java version: 1.8.0_121, vendor: Oracle Corporation</div><div class="line">Java home: C:\Program Files\Java\jdk1.8.0_121\jre</div><div class="line">Default locale: zh_CN, platform encoding: GBK</div><div class="line">OS name: &quot;windows 10&quot;, version: &quot;10.0&quot;, arch: &quot;amd64&quot;, family: &quot;windows&quot;</div></pre></td></tr></table></figure></p>
<h1 id="五、修改默认仓库路径"><a href="#五、修改默认仓库路径" class="headerlink" title="五、修改默认仓库路径"></a>五、修改默认仓库路径</h1><p>Maven默认会在${user}/.m2/repository/ (如：C:/Users/XXX/.m2/repository/)目录下建立仓库，而C盘通常是系统盘，如果文件过多会影响系统速度，因此需要修改。</p>
<p>打开Maven的安装路径，找到conf/settings.xml，在文件中搜索repository，可以找到以下位置<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">settings</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/SETTINGS/1.0.0"</span></span></div><div class="line">          <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">          <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd"</span>&gt;</div><div class="line">  <span class="comment">&lt;!-- localRepository</span></div><div class="line">   | The path to the local repository maven will use to store artifacts.</div><div class="line">   |</div><div class="line">   | Default: $&#123;user.home&#125;/.m2/repository</div><div class="line">  &lt;localRepository&gt;/path/to/local/repo&lt;/localRepository&gt;</div><div class="line">  --&gt;</div></pre></td></tr></table></figure></p>
<p>可以看到默认的仓库路径，我们在后面添加以下代码（仓库路径根据自己喜好而定）<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 配置本地maven仓库路径 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>C:/Program Files/apache-maven-3.5.0/repository<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h1 id="六、第一个Maven项目"><a href="#六、第一个Maven项目" class="headerlink" title="六、第一个Maven项目"></a>六、第一个Maven项目</h1><h2 id="1-建立以下目录结构"><a href="#1-建立以下目录结构" class="headerlink" title="1.建立以下目录结构"></a>1.建立以下目录结构</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">HelloMaven</div><div class="line">|-src</div><div class="line">|   |--main </div><div class="line">|   |   |-java</div><div class="line">|   |   |-resources</div><div class="line">|   |-test</div><div class="line">|       |-java</div><div class="line">|       |-resources</div><div class="line">|-target</div><div class="line">|-pom.xml</div></pre></td></tr></table></figure>
<p>其中pom.xml文件配置如下<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">true<span class="tag">&lt;<span class="name">properties</span>&gt;</span></div><div class="line">truetrue<span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></div><div class="line">true<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>HelloMaven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="2-创建java类"><a href="#2-创建java类" class="headerlink" title="2.创建java类"></a>2.创建java类</h2><p>在<code>src/main/java/cn/maven</code>目录下新建文件Hello.java<br>记得保存时要以UTF-8格式保存，内容如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cn.maven;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span></span>&#123;</div><div class="line">true<span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">()</span></span>&#123;</div><div class="line">true    <span class="keyword">return</span> <span class="string">"Hello Maven"</span>;</div><div class="line">true&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="3-创建测试类"><a href="#3-创建测试类" class="headerlink" title="3.创建测试类"></a>3.创建测试类</h2><p>在<code>/src/test/java/cn/maven</code>目录下新建测试文件TestHello.java，内容如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cn.maven;</div><div class="line"><span class="keyword">import</span> org.junit.Test;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHello</span> </span>&#123;</div><div class="line">true<span class="meta">@Test</span></div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetValue</span><span class="params">()</span></span>&#123;</div><div class="line">truetrueHello h = <span class="keyword">new</span> Hello();</div><div class="line">truetrueSystem.out.println(h.getValue());		</div><div class="line">true&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="4-项目编译与测试"><a href="#4-项目编译与测试" class="headerlink" title="4.项目编译与测试"></a>4.项目编译与测试</h2><p>在项目根路径打开cmd，输入命令mvn compile<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">E:\code\maven&gt; mvn compile</div><div class="line">[INFO] Scanning <span class="keyword">for</span> projects...</div><div class="line">[INFO]</div><div class="line">[INFO] ------------------------------------------------------------------------</div><div class="line">[INFO] Building Hello 0.0.1-SNAPSHOT</div><div class="line">[INFO] ------------------------------------------------------------------------</div><div class="line">[INFO]</div><div class="line">[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ Hello ---</div><div class="line">[INFO] Using <span class="string">'UTF-8'</span> encoding to copy filtered resources.</div><div class="line">[INFO] Copying 0 resource</div><div class="line">[INFO]</div><div class="line">[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ Hello ---</div><div class="line">[INFO] Changes detected - recompiling the module!</div><div class="line">[INFO] Compiling 1 <span class="built_in">source</span> file to E:\code\maven\target\classes</div><div class="line">[INFO] ------------------------------------------------------------------------</div><div class="line">[INFO] BUILD SUCCESS</div><div class="line">[INFO] ------------------------------------------------------------------------</div><div class="line">[INFO] Total time: 1.397 s</div><div class="line">[INFO] Finished at: 2017-07-17T11:05:42+08:00</div><div class="line">[INFO] Final Memory: 13M/257M</div><div class="line">[INFO] ------------------------------------------------------------------------</div></pre></td></tr></table></figure></p>
<p>出现BUILD SUCCESS说明maven项目编译成功！<br>接下来输入mvn test即可执行maven测试<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">E:\code\maven&gt; mvn <span class="built_in">test</span></div><div class="line">[INFO] Scanning <span class="keyword">for</span> projects...</div><div class="line">[INFO]</div><div class="line">[INFO] ------------------------------------------------------------------------</div><div class="line">[INFO] Building Hello 0.0.1-SNAPSHOT</div><div class="line">[INFO] ------------------------------------------------------------------------</div><div class="line">[INFO]</div><div class="line">[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ Hello ---</div><div class="line">[INFO] Using <span class="string">'UTF-8'</span> encoding to copy filtered resources.</div><div class="line">[INFO] Copying 0 resource</div><div class="line">[INFO]</div><div class="line">[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ Hello ---</div><div class="line">[INFO] Nothing to compile - all classes are up to date</div><div class="line">[INFO]</div><div class="line">[INFO] --- maven-resources-plugin:2.6:<span class="built_in">test</span>Resources (default-testResources) @ Hello ---</div><div class="line">[INFO] Using <span class="string">'UTF-8'</span> encoding to copy filtered resources.</div><div class="line">[INFO] Copying 0 resource</div><div class="line">[INFO]</div><div class="line">[INFO] --- maven-compiler-plugin:3.1:<span class="built_in">test</span>Compile (default-testCompile) @ Hello ---</div><div class="line">[INFO] Changes detected - recompiling the module!</div><div class="line">[INFO] Compiling 1 <span class="built_in">source</span> file to E:\后端视频\code\maven\target\<span class="built_in">test</span>-classes</div><div class="line">[INFO]</div><div class="line">[INFO] --- maven-surefire-plugin:2.12.4:<span class="built_in">test</span> (default-test) @ Hello ---</div><div class="line">[INFO] Surefire report directory: E:\后端视频\code\maven\target\surefire-reports</div><div class="line"></div><div class="line">-------------------------------------------------------</div><div class="line"> T E S T S</div><div class="line">-------------------------------------------------------</div><div class="line">Running cn.maven.TestHello</div><div class="line">Hello Maven</div><div class="line">Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.039 sec</div><div class="line"></div><div class="line">Results :</div><div class="line"></div><div class="line">Tests run: 1, Failures: 0, Errors: 0, Skipped: 0</div><div class="line"></div><div class="line">[INFO] ------------------------------------------------------------------------</div><div class="line">[INFO] BUILD SUCCESS</div><div class="line">[INFO] ------------------------------------------------------------------------</div><div class="line">[INFO] Total time: 1.621 s</div><div class="line">[INFO] Finished at: 2017-07-17T11:11:47+08:00</div><div class="line">[INFO] Final Memory: 15M/264M</div><div class="line">[INFO] ------------------------------------------------------------------------</div></pre></td></tr></table></figure></p>
<p>可以看到测试类里的结构输出正确，为“Hello Maven‘’。</p>
<p>至此，恭喜你已经完成了第一个Maven项目！</p>
<p>感谢您的阅读，希望能对您有所帮助！</p>
<blockquote>
<p>更多关于Maven的文章，请参阅：</p>
<p><a href="">暂无</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;一、Maven简介&quot;&gt;&lt;a href=&quot;#一、Maven简介&quot; class=&quot;headerlink&quot; title=&quot;一、Maven简介&quot;&gt;&lt;/a&gt;一、Maven简介&lt;/h1&gt;&lt;p&gt;一个软件构建的生命周期有：&lt;br&gt;清除–&amp;gt; 编译–&amp;gt;测试–&amp;gt;报告–
    
    </summary>
    
      <category term="Maven" scheme="https://soarkey.github.io/categories/Maven/"/>
    
    
      <category term="Maven" scheme="https://soarkey.github.io/tags/Maven/"/>
    
  </entry>
  
  <entry>
    <title>持久层设计理念的演变</title>
    <link href="https://soarkey.github.io/2017/07/12/%E6%8C%81%E4%B9%85%E5%B1%82%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5%E7%9A%84%E6%BC%94%E5%8F%98/"/>
    <id>https://soarkey.github.io/2017/07/12/持久层设计理念的演变/</id>
    <published>2017-07-12T00:00:00.000Z</published>
    <updated>2017-08-29T13:10:15.351Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>MVC架构中的Model层是与业务逻辑和数据关联最为紧密的部分，持久层作为Model层面的主要组成，其设计的优劣势必对系统的整体表现产生至关重要的影响。<br> —— 《深入浅出Hibernate》</p>
</blockquote>
<h1 id="持久层是什么"><a href="#持久层是什么" class="headerlink" title="持久层是什么"></a>持久层是什么</h1><p>持久层是在系统逻辑层面上，专注于实现数据持久化的一个相对独立的领域。说白了就是应用与数据库之间沟通的“桥梁”，将数据库代码和应用业务代码从耦合的关系中脱离出来。</p>
<h1 id="持久层设计与解耦思想演进"><a href="#持久层设计与解耦思想演进" class="headerlink" title="持久层设计与解耦思想演进"></a>持久层设计与解耦思想演进</h1><p>简而言之，解耦就是将原先关联程度比较高的两个事物或者多个事物通过一些手段来达到降低其关联程度的效果。</p>
<blockquote>
<p>解耦合设计要达到的目标</p>
<p>1.应用层解耦合–应用逻辑与数据逻辑相分离</p>
<p>2.资源层解耦合–逻辑结构与物理结构相分离</p>
</blockquote>
<h2 id="1-早期混乱的JDBC"><a href="#1-早期混乱的JDBC" class="headerlink" title="1.早期混乱的JDBC"></a>1.早期混乱的JDBC</h2><p>早期的对数据库的操作功能是在JDBC基础上直接实现的，其中糅合着大量的JDBC连接代码和SQL代码，显得极为混乱。<br>例如：用户查询账户余额<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">selectAmount</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">trueConnection conn = <span class="keyword">null</span>;</div><div class="line">trueStatement stmt = <span class="keyword">null</span>;</div><div class="line">trueResultSet rs = <span class="keyword">null</span>;</div><div class="line">true<span class="keyword">double</span> amount = <span class="number">0</span>;</div><div class="line">true<span class="keyword">try</span>&#123;</div><div class="line">truetrueClass.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</div><div class="line">truetrueconn = DriverManager.getConnection(</div><div class="line">truetruetruetrue<span class="string">"jdbc:mysql://localhost:3306/demo"</span>, <span class="comment">//url</span></div><div class="line">truetruetruetrue<span class="string">"root"</span>, <span class="comment">//user</span></div><div class="line">truetruetruetrue<span class="string">"123456"</span>  <span class="comment">//password</span></div><div class="line">truetruetruetrue);</div><div class="line">truetruestmt = conn.createStatement();</div><div class="line">truetrueString sql = <span class="string">"select amount from user where id = "</span>+id+<span class="string">";"</span>;</div><div class="line">truetruers = stmt.executeQuery(sql);</div><div class="line">truetrue<span class="keyword">while</span>(rs.next())&#123;</div><div class="line">truetruetrueamount = rs.getDouble(<span class="number">1</span>);</div><div class="line">truetrue&#125;</div><div class="line">true&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">truetruee.printStackTrace();</div><div class="line">true&#125; <span class="keyword">finally</span> &#123;</div><div class="line">truetrue<span class="keyword">if</span> (conn != <span class="keyword">null</span>) &#123;</div><div class="line">truetruetrue<span class="keyword">try</span> &#123;</div><div class="line">truetruetruetrue<span class="keyword">if</span> (stmt != <span class="keyword">null</span>) &#123;</div><div class="line">truetruetruetruetrue<span class="keyword">try</span> &#123;</div><div class="line">truetruetruetruetruetruestmt.close();</div><div class="line">truetruetruetruetrue&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">truetruetruetruetruetruee.printStackTrace();</div><div class="line">truetruetruetruetrue&#125;</div><div class="line">truetruetruetrue&#125;</div><div class="line">truetruetruetrueconn.close();</div><div class="line">truetruetrue&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">truetruetruetruee.printStackTrace();</div><div class="line">truetruetrue&#125;</div><div class="line">truetrue&#125;</div><div class="line">true&#125;</div><div class="line">true<span class="keyword">return</span> amount;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>上面这段代码虽然完成了要求的功能，但SQL和业务的相互耦合会使得日后的修改变得非常困难，而且一旦数据库发生变更，对与开发者而言将会是一个噩梦。</p>
<h2 id="2-XML配置文件实现参数化"><a href="#2-XML配置文件实现参数化" class="headerlink" title="2.XML配置文件实现参数化"></a>2.XML配置文件实现参数化</h2><p>相比于将数据库连接用户密码暴露在数据库操作代码中，利用XML文件配置连接将会是一个更便捷高效的方法。</p>
<p>举个例子，XML配置文件可以这样写<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">database</span> <span class="attr">name</span>=<span class="string">"mysqldb"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">driver</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">driver</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>jdbc:mysql://localhost:3306/demo<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">user</span>&gt;</span>root<span class="tag">&lt;/<span class="name">user</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">password</span>&gt;</span>root<span class="tag">&lt;/<span class="name">password</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">database</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>然后再用Java读取XML文件进行连接配置，这样就可以省去日后数据库用户名和密码变更的麻烦了，而且只需要维护一份XML文件，工作量相比之前大大减少了。</p>
<h2 id="3-JDBC工具类"><a href="#3-JDBC工具类" class="headerlink" title="3.JDBC工具类"></a>3.JDBC工具类</h2><p>对之前的模式进行重新审视后，我们发现这其中有一个共同点，就是每个业务中都将涉及获取数据库连接的获取和释放，能不能将这些共同的代码抽离出来呢？</p>
<p>很自然地，我们就能想到用一个类封装数据库的连接和获取，对外提供统一的方法操作。</p>
<p>代码示例：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBUtils</span> </span>&#123;</div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span> </span>&#123;</div><div class="line">truetrueConnection conn = <span class="keyword">null</span>;</div><div class="line"></div><div class="line">truetrueString url = <span class="string">"jdbc:mysql://localhost:3306/demo"</span>;</div><div class="line">truetrueString username = <span class="string">"root"</span>;</div><div class="line">truetrueString password = <span class="string">"123456"</span>;</div><div class="line"></div><div class="line">truetrue<span class="keyword">try</span>&#123;</div><div class="line">truetruetrueClass.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</div><div class="line">truetruetrueconn = (Connection) DriverManager.getConnection(url,username,password);</div><div class="line"></div><div class="line">truetruetrue<span class="keyword">if</span>(conn != <span class="keyword">null</span>)&#123;</div><div class="line">truetruetruetrueSystem.out.println(<span class="string">"hello"</span>);</div><div class="line">truetruetrue&#125;</div><div class="line"></div><div class="line">truetrue&#125;<span class="keyword">catch</span>(Exception e)&#123;</div><div class="line">truetruetruee.printStackTrace();</div><div class="line">truetrue&#125;</div><div class="line">truetrue<span class="keyword">return</span> conn;</div><div class="line">true&#125;</div><div class="line"></div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">closeConnection</span><span class="params">(Connection conn)</span> </span>&#123;</div><div class="line">truetrue<span class="keyword">try</span>&#123;</div><div class="line">truetruetrueconn.close();</div><div class="line">truetrue&#125; <span class="keyword">catch</span> (SQLException e) &#123;</div><div class="line">truetruetruee.printStackTrace();</div><div class="line">truetrue&#125;</div><div class="line">true&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="4-DAO模式的出现"><a href="#4-DAO模式的出现" class="headerlink" title="4.DAO模式的出现"></a>4.DAO模式的出现</h2><p>虽然XML文档配置是个不错的方法，但是我们的系统可能有成百上千的业务过程，每一个业务处理中都涉及许多重复不必要的数据库连接的获取、操作和释放过程，代码冗余，效率很低。<br>为了解决这个问题，我们便引入了DAO(Data Access Object)模式，通俗地说就是将对数据的增删改查操作统一封装到数据操作类中，将业务流程封装到业务逻辑类中，从而将数据访问和业务逻辑分离开来，解除两者之间的耦合关系。</p>
<p>DAO模式的实现层次图：</p>
<p><img src="https://static.oschina.net/uploads/img/201707/12093639_R4gB.jpg" alt="DAO模式的实现层次图"></p>
<blockquote>
<p>某种意义上说，DAO = Data + Accessor + Domain Object</p>
<p>Domain Object即是代码中常用的Java Bean对象</p>
</blockquote>
<p>简单描述：<br>我们以用户登录为例，来讲解DAO模式从上到下的层次。</p>
<p>（1）业务逻辑类</p>
<p>只负责业务的实现过程，而无需顾及数据的具体操作，例如<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> Class UserService&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">login</span><span class="params">(String username, String password)</span></span>&#123;</div><div class="line">        UserDao userDao = <span class="keyword">new</span> UserDao();</div><div class="line">        User user = userDao.login(username,password);</div><div class="line">        <span class="keyword">return</span> user;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>（2）数据库操作类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> Class UserDao&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">login</span><span class="params">(String username, String password)</span></span>&#123;</div><div class="line">truetrueString sql = <span class="string">"..."</span>; <span class="comment">//sql代码</span></div><div class="line">truetrueConnection conn = (Connection) JDBCUtil.getConnection();</div><div class="line">truetrueUser user = <span class="keyword">null</span>;</div><div class="line">truetrue<span class="comment">//...  对数据库的具体操作省略</span></div><div class="line">truetrue<span class="keyword">return</span> user;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="comment">//...</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="comment">//...</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>（3）Java Bean类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</div><div class="line">true<span class="keyword">private</span> String id;</div><div class="line">true<span class="keyword">private</span> String username;</div><div class="line">true<span class="keyword">private</span> String password;</div><div class="line"></div><div class="line">true<span class="comment">//... getters和setters方法</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这种方式很好地将数据访问底层实现和业务层分离开来，意味着我们可以在上层不变的前提下，仅仅通过更换底层实现来切换数据库访问的机制，从而可以让我们的应用部署在不同的数据库平台上。更重要的是，我们可以加入数据库连接池及各种缓存机制（如Statement Cache，Data Cache），从而提升整个系统的性能。</p>
<p>但是，换个角度思考，我们虽然能够通过静态更换底层实现实现部署到不同的数据库平台上，但是这样的方式在面对较大的系统时，部署和维护工作将会变得非常棘手。</p>
<p>在面向对象设计中“可复用设计”中有一条原则，叫做“开闭原则”–对扩展开放，对修改关闭，说的通俗一点就是软件系统中包含的各种组件，例如模块、类以及功能等等，应该在不修改现有代码的基础上，引入新功能。我们应该把DAO模式中存在的变动因素屏蔽在系统之外。</p>
<p>由此，在DAO层引入了工厂模式(Factory)、代理模式(Proxy)。</p>
<h2 id="5-工厂模式和代理模式"><a href="#5-工厂模式和代理模式" class="headerlink" title="5.工厂模式和代理模式"></a>5.工厂模式和代理模式</h2><p>由于需要针对不同的数据库提供各自的DAO实现，很自然我们就联想到可以抽象出一个调用接口，通过调用接口作为调用界面和规范，从而避免对代码具体实现的依赖。</p>
<h3 id="1-工厂模式"><a href="#1-工厂模式" class="headerlink" title="1.工厂模式"></a>1.工厂模式</h3><p>作为最常用的创建模式，工厂模式可以实现按需加载相应的实现提供给业务层。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">UserDao userDao = DAOFactory.getDAO(UserDao.class);</div><div class="line">User user = userDao.getUser(id);</div></pre></td></tr></table></figure></p>
<p> 工厂模式UML图：</p>
<p><img src="https://static.oschina.net/uploads/img/201707/12093739_Wrbu.png" alt="工厂模式UML图"></p>
<p>以下简易实例中使用工厂模式实现DAO类的按需创建。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DAOFactory</span></span>&#123;</div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> UserDao <span class="title">getUserDAO</span><span class="params">()</span></span>&#123;</div><div class="line">truetrue<span class="keyword">return</span> <span class="keyword">new</span> UserDao();</div><div class="line">true&#125;</div><div class="line"></div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> xxxDao <span class="title">getxxxDAO</span><span class="params">()</span></span>&#123;</div><div class="line">truetrue<span class="keyword">return</span> <span class="keyword">new</span> xxxDao();</div><div class="line">true&#125;</div><div class="line">true<span class="comment">//...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>业务代码就变成了这样<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> Class UserService&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">login</span><span class="params">(String username, String password)</span></span>&#123;</div><div class="line">        User user = DAOFactory.getUserDAO().login(username,password);</div><div class="line">        <span class="keyword">return</span> user;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>看起来不错，但是每次都要通过DAOFactory的方法创建DAO类，导致整段代码中充斥着重复的部分，有没有办法解决它呢？</p>
<h3 id="2-代理模式"><a href="#2-代理模式" class="headerlink" title="2.代理模式"></a>2.代理模式</h3><p>代理模式的引入正好解决了以上出现的问题。怎么回事呢？让我们先来了解一下代理模式是什么。</p>
<p>代理模式的UML图</p>
<p><img src="https://static.oschina.net/uploads/img/201707/12093828_KYvQ.png" alt="代理模式UML图"></p>
<p>一句话概括，代理模式就是在你和目标对象中间设置一个代理，你只需要告诉代理你现在需要登录，代理就会自动帮你把新建对象，操作对象等等全部搞定了。</p>
<p>让我们看看经过代理模式改造之后的代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserProxy</span></span>&#123;</div><div class="line">true<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> User <span class="title">login</span><span class="params">(String username, String password)</span></span>&#123;</div><div class="line">truetrueUser user = DAOFactory.getUserDAO().login(username,password);</div><div class="line">truetrue<span class="keyword">return</span> user;</div><div class="line">true&#125;</div><div class="line">true<span class="comment">//...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>于是业务代码就变得非常简洁，看起来比最开始的业务层代码好多了。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> Class UserService&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">login</span><span class="params">(String username, String password)</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> UserProxy.login(username,password);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>到现在，我们已经差不多解决了持久层的解耦合问题了，那么持久层的设计思想是不是到此就结束了呢？我们是不是已经找到了适应所有web应用的模式呢？</p>
<p>不是的。<br>无论什么应用，都无法脱离对资源的管理和使用，对于持久层而言，资源的调度和管理就显得尤为重要。<br>由于对数据库的操作过程中存在许多消耗资源的“重量级”操作，所以优化持久层的资源管理调度也是持久层设计理念发展过程中希望达到的目标。可见一个好的设计能够提升性能，提升系统的伸缩性、可维护性。</p>
<p>那么我们要怎么优化持久层呢？ORM(Object/Relational Mapper)思想乃至持久层框架的出现是为了解决什么问题呢？Hibernate、Apache OJB、iBatis是如何对持久层进行处理的呢？我们能不能一劳永逸地解决持久层存在的问题呢？</p>
<p>敬请期待下一篇博文，带你探秘持久层的设计理念。</p>
<p>感谢您的阅读！如果对您有一点点帮助的话，那将是我莫大的荣幸！</p>
<h1 id="相关学习资源"><a href="#相关学习资源" class="headerlink" title="相关学习资源"></a>相关学习资源</h1><p> XML：</p>
<p>1.<a href="http://www.runoob.com/xml/xml-tutorial.html" target="_blank" rel="external">菜鸟教程-XML教程</a></p>
<p>2.<a href="http://www.imooc.com/learn/171" target="_blank" rel="external">慕课网-Java眼中的XML-文件读取</a></p>
<p>设计模式：</p>
<p>1.<a href="http://blog.csdn.net/eson_15/article/details/51223124" target="_blank" rel="external">java设计模式-工厂模式</a></p>
<p>2.<a href="https://zh.wikipedia.org/wiki/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F" target="_blank" rel="external">维基百科-代理模式</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;MVC架构中的Model层是与业务逻辑和数据关联最为紧密的部分，持久层作为Model层面的主要组成，其设计的优劣势必对系统的整体表现产生至关重要的影响。&lt;br&gt; —— 《深入浅出Hibernate》&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id
    
    </summary>
    
      <category term="持久层" scheme="https://soarkey.github.io/categories/%E6%8C%81%E4%B9%85%E5%B1%82/"/>
    
    
      <category term="设计模式" scheme="https://soarkey.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="hibernate" scheme="https://soarkey.github.io/tags/hibernate/"/>
    
  </entry>
  
  <entry>
    <title>马云清华EMBA演讲：一个人要成功靠情商 要不败靠智商</title>
    <link href="https://soarkey.github.io/2017/04/21/%E9%A9%AC%E4%BA%91%E6%B8%85%E5%8D%8EEMBA%E6%BC%94%E8%AE%B2/"/>
    <id>https://soarkey.github.io/2017/04/21/马云清华EMBA演讲/</id>
    <published>2017-04-21T00:00:00.000Z</published>
    <updated>2017-04-21T15:38:27.367Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>转载</p>
</blockquote>
<p>10月20日，马云走进清华EMBA课堂，发表了题为“企业家精神与未来”的主题演讲。</p>
<a id="more"></a>
<h2 id="导读"><a href="#导读" class="headerlink" title="导读"></a>导读</h2><p>10月20日，阿里巴巴董事局主席马云作为清华大学经济管理学院顾问委员会委员，<br>走进清华EMBA课堂，发表了题为“企业家精神与未来”的主题演讲。</p>
<p>在半小时的演讲中，马云谈及人性、教育、学习、企业家精神、未来等。</p>
<p>马云承认自己书看得不多，但他不认为读书无用。<br>他说，一个人要成功，靠情商；一个人要不败，靠智商。<br>自己跟其他企业家的区别在于，喜欢把人当书去看，而不是把书当人看。</p>
<h2 id="附：马云演讲实录"><a href="#附：马云演讲实录" class="headerlink" title="附：马云演讲实录"></a>附：马云演讲实录</h2><p>大家好！我心里觉得有一个工作我从来没忘记过，我是一个老师出身，学的是师范，在大学教了六年书，创业的时候我自己有一个东西从来没丢过，那就是当老师，我可能花了很多时间，比任何一个CEO都多的时间，在外面交流、讲课、聊天。</p>
<p>可能没有像我这么高调的一个人，到处去讲，这是职业病。因为老师一个很重要的职责就是分享自己，很多知识不是老师的，但是你必须要去分享。我在大学里面教的六年书中，其中做了三年班主任，当班主任的经历，让我受益匪浅。</p>
<p>最重要的，我当老师学到了两样东西。第一，老师永远希望学生超过自己，这个素质也是当CEO一定要有的一个素质。天下的老师都希望这个学生当老板，那个学生成为银行家，这个学生当了县长，当了书记，那个学生当了优秀的科学家，没有一个老师希望这个学生被双规了，那个学生破产了，那个进了监狱，所以老师最佳的产品就是学生，学生越好，老师才会越好。</p>
<p>这是我当老师学到的第一样东西，这么多年来，伴随我整个生命。我真正出来创业是在1995年，那一年我离开大学，但是当老师是我永远的一种职业病，我希望加入阿里巴巴的员工每个人都超越我，每个人都超越自己，这是骨子里的东西。</p>
<p>第二，老师很重要的职责就是经验分享，不管别人要听不要听，你要自己知道的要跟大家分享。即使我不懂，很专业的事情，我也学会之后再分享。老师也要不断学习。在中国企业家里面，估计我应该排前十个。创业以来，我没有再回大学认认真真坐下来听过一个月的课，但是我几乎跑遍了很多国家，很多公司。</p>
<p>比尔·盖茨、巴菲特、只要是全世界今天还活着的那些老大们，企业家、政治家，我能有机会，我都愿意见，因为都是学习，并非只有坐在校园里面才是学习。我书确实看的不多，这点我承认。但我从来没说过读书无用。</p>
<p>一个人要成功，靠情商；一个人要不败，靠智商。成功有时候你情商很高，搞定一个人，搞定一个机会，也许你就起来了。但是你要不败，一定是靠智商，智商就是你要不断的学习。</p>
<p>智商低的人，没有愿意人跟着你干的；情商低的人，是没有办法管理一批智商高的人。智商高的人有时候是很难管的，你如何用情商？这个情商不是跟人斗。</p>
<p>一个老板要成功，绝大部分要有三个商，第一情商（EQ），第二智商（IQ），这两个之外，还有一个爱商，大爱之商。你如果没有对未来、对社会、对将来、对人之间有一种爱心的话，真正的人才不会跟着你的。这三个商合在一起，你才能成为一个领导者。</p>
<p>我自己觉得当老师比我的另外一个身份重要。你们看各种各样的老师，老师的成功往往是从学生当中学到很多东西。我过去觉得自己可能跟其他企业家的区别在于，我喜欢把人当书去看，而不是把书当人看。有些书我看了第一页，前面几页，我就知道后面的故事，你是能够感觉到一个人的境界，一本书的境界。有些书我一天翻了就扔掉，有些书我可能像老子的道德经，儒家的论语，我可能看十年，我有空没空都要看，短短几十个字，我可能看三四个月，还在翻来覆去的看这个东西，因为这中间是要慢慢去体会的。</p>
<p>最近大家都在讲文化自信，文化自信很重要的一点，文化自信是基于你对其他文化的理解和尊重。上个月我在美国纽约参加一个很有名的一个机构的座谈，我是一个中国人，他们把所有的高管叫过来跟我对话，大家都提到一个问题，中美之间的冲突，东西方文化之间的冲突。我听到他们都在批判我们中国这个不对那个不对，我说：“中国是以儒释道文化为基础的，请问大家都在批评中国，在座二十几个老外，请问谁看过老子的道德经？或者，孔夫子是你们所有人都知道的，在座的有没有人看过一篇论语？有没有人看过一篇我们的佛经？”这些老外们说“没有”。当时，我告诉他们，我看过五遍圣经。虽然我没在美国读过一天书，但是我大学那时候学英文，我把圣经当做英文教材来看。我们的儒释道文化之强盛是老外没有体验到的。对另外的文化不了解，你就没有资格批评。</p>
<p>几乎每个国家企业，只要是企业，都有强大的文化作为背景。而文化的根源是跟宗教、信仰是有关的。什么是中国企业？中国企业今天来讲，我们当然可以学日本、韩国、欧美。人家是有根基的，欧美这套体系是有基本的基督教的文化。以色列企业有自己的文化，日本的企业也是有自己的文化，我从多年以前开始觉得如果阿里有一天希望成功的话，我们必须在中国的文化里面找到自己的根基。</p>
<p>所以我才会去听听道家讲的，很有道理，无为而治，“无为”是什么意思？大家明白没有？每个人的说法都不一样。我的理解，无为，就是你明知道没有结果仍为之。人想透一点，不管你多牛，八十岁九十岁，来的的地方不同，去的地方一样，全是火葬场，人都要死的，为什么还要那么努力？企业也一样，从企业成立第一天起就要想好关门的那一天，但是仍然要快快乐乐的过好每一天。道家永远讲究和谐，跟自然的和谐。</p>
<p>关于企业管理，很多人学MBA。这么多年了，我觉得MBA是很了不起的一个东西，我认为MBA的体系很好。但是不要以为MBA一定能做好生意。另外，MBA讲的太多成功案例，我认为企业应该多学习失败，因为商场如战场。商场是没有演习的，冲出去，说我再来一遍行不行？不行，像破产就破产了。做生意的人都是聪明的人，那么多聪明的老板倒下了，你为什么没有倒下？</p>
<p>我走访过很多老兵，老兵很有意思，会告诉你你要知道哪个位置有冷弹，哪个地方有地雷，你搞清楚，保存自己才能活下来。类似的，我们也必须学习其他企业失败的经验教训，但是千万不要把MBA给神化了，MBA把你的公司战略各个方面清晰，这是一个工具，但你不要以为有了工具你就能成功。</p>
<p>儒家思想在中国是最牛的。儒家思想讲社会管理治理体系，讲人与社会如何和谐相处，这中间能够学到很多牛的管理。真正的管理是什么？管理是管理人性，我们这几天开了战略会议，我对技术是很遥远的，一会儿别问我技术问题。但是对人性的理解，对社会未来趋势的把握，这方面你是可以学习的。儒家思想很了不起，对社会治理的体系，封建社会两千多年靠的是儒家思想这么下来，它有很多的东西在里头。大家要认真的去体会。</p>
<p>佛家思想讲究人与心之间配合，你在佛家也能学到很多东西。你生意做到一定程度的时候，没有佛家那种思想，也不行。如果你在竞争之中没有道家思想，也没有机会赢。如果公司长到一定程度，你不懂得儒家思想的组织体系建设，你没有机会能够持久。当然你要在走向全球的时候，如果你不懂基督教的文化，你不懂得伊斯兰教的文化，你是没有办法走遍世界的。</p>
<p>我自己觉得做生意就是一个学习过程，如果你不了解你的员工，你的企业不可能有创新。如果你不去了解你的竞争对手，你的企业永远不会成长。道家讲心中无敌，无敌于天下，不是真正的不尊重对手，而是真正尊重对手，才懂得我的对手在更高。你如果这种状态，你的企业自然会做的不一样。我想如果你在碰到竞争的时候，不妨思考两种，第一，道家思想的竞争是很有意思的，太极的竞争思想是世界上第一的。西方也是竞争思想，基督教是是黑和白之间。道家的思想将黑和白之间交融，我告诉大家，企业家如果你出去做生意，碰到竞争，火气就特别大，恨不得把竞争对手按到马桶里，你是做不长的。因为对手到处都在，按死了这个，还出来一个，你就变成了一个职业杀手，你成不了大事。</p>
<p>我们在竞争过程当中要思考的就是这种对手要尊重他，会战者不怒，真正会打仗的不会生气的。为什么计算机会超过人类？计算机没情趣，我有时候下棋，我下围棋，我是一定找比我技术差的人下，就是找乐趣。如果被人家杀的痛苦，何必呢。所以会战的真正的高手没有情趣，我生气是好不容易搞起来了，被他拦腰砍断，我会生气，会输。做企业也一样，你如果动不动发员工的脾气，甚至对竞争对手深恶痛绝，你的企业做不大的。谁都是你的对手，小有小的对手，中有中的对手，大有大的对手，国家有国家的对手，时代有时代的对手，如果竞争过程中，你越来越痛苦，对手越来越高兴，你一定做错了。应该是对手越来越痛苦，你应该越来越高兴，那就对了。竞争我们是要去思考的，你如果担心竞争就不要做生意，担心失败就不要做生意。谁保证你一定不会失败？你要担心死就不要活着。</p>
<p>要保持良好的心态，阿里这么多年下来，我们这帮人保持良好的心态很重要。不管别人怎么激怒我们，我们尽量做到不怒。不管市场多么混乱，在混乱的时候我们冷静，在外面特别冷静的时候，我们内部得搞混乱了。这个是一种完全的调整心态的策略，所以我想我们在整个学习商业中最重要的就是学习文化，学习组织的方式，学习儒家组织好自己，适应社会，道家讲适应整个自然环境，佛家讲人怎么把自己的行为和行为统一起来。企业做大的时候，麻烦多了去了。你怎么干都是错的，怎么办呢？看看经也蛮好。当然挺难看懂的，我不知道你们，我学英文，我听老外讲佛经的时候，我特别听的懂，中国一些人讲，我反而听不懂，故弄玄虚的太多。我也去寺庙，我是拜菩萨，到了道家我觉得那个也很好，孔夫子也不错，到了教堂里面我也是这样，他们是比我们聪明，从每个人身上你能够学到很多东西。</p>
<p>中国和西方之间，基督教文化非常了不起，圣经是世界上最牛逼的畅销书，佛经没有几个人看得懂，它不是畅销书，它要靠你自己悟，悟就麻烦了。菩萨手这样一弄，有的人明白了，其他人完全不明白，想的完全不一样。悟也让我们悟到了精髓，悟也让我们东方文化很难全球传播。这方面，真正悟到的高手还是相当的高，但绝大部分的人是能听的懂，每个故事都有对应。我希望我们在这里面，每个做企业的人你们面对的是巨大的市场，巨大的竞争，你们面对的是自己的员工，你面对的是客户，你面对的是股东，你面对的是政府的监管，你面对的是各种各样不可预测的未来。所以如果没有良好的心态，没有强大的内心文化，知道自己要什么，放弃什么，每个人知道自己有什么，你到底要什么，你要放弃什么，就没法做好企业。企业如人，企业要想明白，你们企业有什么，最重要的是你放弃什么，没想明白自己放弃什么的人是根本不明白自己坚持什么，企业也一样。企业经常是我能干这个，谁都能干这个，问题是你该干什么，不是你能干什么，而是该干什么。这些问题，这些思考都是从文化积累出来的。</p>
<p>讲了这些以后，我想讲一些未来，我对未来的想法相对比较感兴趣。我刚才讲了，MBA是知识的积累，没有知识，你要想不失败，一定要靠知识，你要想成功，也许情商管用。但是对未来，大家知道我对经济学家意见挺大的。我尊重经济学，但是我不尊重今天的很多经济学家。我跟很多经济学家聊天聊过，我都听不懂他们在说什么，很多经济学家讲的跟脱口秀一样，经济学家是研究，根据数据来研究昨天的规律，以便未来的人决策做参考。第一，我们在中国数据是最缺的，第二，这帮经济学家是研究学问的人，研究学问的人他讲的很多话其实是不太听的懂的。今天在电视上面胡说八道，另外一个研究昨天的人和研究未来的人是完全不同的视角，经济学家原则上是研究昨天的，春江水暖鸭先知，企业家是对未来的判断，我们必须对未来判断。</p>
<p>我希望企业家一定要对未来进行判断。我告诉大家的是，今天的时代是人类历史上的第三次技术革命，远远超过我们在座人的想象。第一次技术革命，工业革命大家知道，工业革命出来以后，对社会的冲击超过了大家的想象，煤成为了主要的动能。人的体力，人的能力，原来人的力量比不了机器，机器出来的时候，人就基本放弃了，力气比不过机器。导致的直接结果是第一次世界大战，力量平衡发生了变化。第二次技术革命，能源革命，石油成为了主要的能源，直接的结果，第二次世界大战。这次技术革命是脑袋的释放，是智慧的释放，是知识的释放，是大脑的解放。</p>
<p>每一次技术革命出来以后，人类往往根本没有准备。例如第一次技术革命来的时候，汽车出来的时候，第一个生气的是马车夫，必须把汽车给砸了，要不砸了它，他们就没饭吃了，那时候马车夫是白领技术活，突然汽车来了，就没有马车夫了。马车夫到政府抗议，怪汽车破坏了他们的就业，最后欧洲曾经出过一个法律，汽车不允许上路。为什么？很多的就业会被取消。</p>
<p>我小时候，那时候修皮鞋可是技术活，裁缝也是技术活，我爸一个月的工资买不了一双鞋，当然要修。结果来了一个流水线革命，这些活都没了。我告诉大家，未来三十年全世界今天看来很多技术活的东西都没了，人类从发明机器的时候，要明白机器会比你人的力气大。人类在发明火车、飞机的时候，人一定要知道我速度跑不过它。人类发明电脑这一天，人类要知道电脑一定比你聪明，否则你发明它干什么。但是我告诉大家一个悲剧的事情，电脑会越来越聪明，电脑会让机器变成人。过去二十年我们把人变成了机器，未来二三十年我们把机器变成了人，机器会越来越聪明。机器打败人能够解决的问题，只是给你丧失了一点自信心而已，机器做人做不到的事情，要解决的人解决不了的问题，这才是真正的牛。二三十年以后，我们要记住，昨天的机器只是我们的工具，未来的机器将会成为人类的合作伙伴。必须对未来有判断，必须知道我这个行业会不会改变。</p>
<p>很多人讨厌互联网，摧毁了传统机器，是吗？这是缺乏远见，是落后思想，是马车夫思想，认为它摧毁了我。你怎么讨厌都没用，这是一场革命。而且告诉大家，这个车已经发动了，任何一场技术革命都要五十年，前面二十几年，一定是纯技术公司的折腾，未来三十年是技术在社会各方面的运用。互联网到现在为止刚好二十年上下，无论facebook也好，谷歌也好，腾讯也好，阿里也好，折腾来折腾去，关键的是未来三十年。如果这些公司不能参与到社会变革，不能参与帮助更多的企业和老百姓搬到网上去，搬到未来的数据时代去，这些企业都会死掉。不要赢了一场战役，但却丢失了一场战争。未来三十年90%的企业都不得不变数据化，未来三十年数据将成为真正最强大的能源，这个变革绝大部分人没想好，包括大学教育会发生天翻地覆的变化。</p>
<p>我刚才看清华的资料，挺有意思，清华还是很有远见的，已经开始互联网教育。未来的大学教育，如果你继续教知识，该教还得教，但是机器比你厉害不知道多少倍，机器不生气，没情趣，不怕饿，插上电，死干。你看一遍，我们顶尖的围棋高手能想到二十步，已经顶尖了，机器这哥们两万步都算好了，你没脾气。所以你要拼知识，未来很难，未来的大学要多关注创造力和想象力的培养。但是中国今天有多少大学有创造力和想象力？因为人和机器拼知识，我反正放弃了，就等于你要跟火车比谁快，跟飞机比谁能跑远。但是人和机器未来的角逐就是在智慧，在使命，在价值观上面。</p>
<p>学校的学习是什么概念？学习和教育是两个不同的词，“教”教的是知识，“育”育的是文化。人与机器之间的差异，未来知识之间的差异不多，但是文化之间的差异可大了去了。如果我们未来的孩子不在文化上多花时间，琴棋书画，文化是培养出来的，不在这上面努力，完了。你最后越来越沮丧，连机器也搞不过它，必须为我们后代思考这个问题，我们要强化“育”的部分。中国的教育差，中国的教师不差的，中国教师差什么？我们最差的中学学生放到美国都是好的学生，结果未来计算机背的更快，算的比你更快。“教”我们不差，但“育”很差，“育”越差，会让我们越来越原来远离世界，世界会变得非常冷酷。</p>
<p>还有学和习这两个概念，“学”是你在学习知识，为什么很多大学生到公司里面，真的要花很多时间我们把他重新改过，因为他们没有“习”。“习”是犯错误，“习”是一种想象力，“习”是一种文化，所以教育、学习是两个概念，“育”和“习”是对文化来说的，“教”和“学”是对知识结构来说的，从小学、中学、大学的教育，未来三十年是学习能力的竞争，是创新能力的竞争。MBA也要思考这个问题，所有人类可以写清楚的事情，机器可以比你们做的更好。</p>
<p>商业是是一门科学，也是一门艺术。这两个之间如果不结合，麻烦就大了。这是我的一些看法，所以我希望大家去思考未来的企业，一定不是工业时代的标准化和规模化，未来的企业一定是数据时代的个性化、定制化。未来的企业拼的一定是创新的能力，而创新的能力当中，知识很重要，但是文化变得更重要。如果你觉得未来不行，是你的想象力不够，如果你认为未来就这个样子，也是想象力不够。所以MBA该怎么样，企业该怎么样，你今天的选择奠定了未来三十年，未来的三十年很多行业会发生天翻地覆的变化。</p>
<p>每个人想想自己的职业，每个人想想自己的未来，每个人想想自己的孩子，重新设计，这不是危言耸听。这是一个挑战，这是一个机会。机会的关键在于你怎么改变自己。这个真正的会影响，而且速度会越来越快，后面二三十年会越来越快，会加速度，直到五十年以后，世界格局重新开始。世界格局的变化是昨天强的人转瞬之间就会变得弱，当年大清王朝是很牛的，英国算什么！倒过来了，英国还没坐稳凳子呢，美国强大了。现在形势又变了，这是我对大家想强调的，而且不是危言耸听，正在发生，而且速度越来越快。</p>
<h2 id="提问环节"><a href="#提问环节" class="headerlink" title="提问环节"></a>提问环节</h2><blockquote>
<p>学生：<br>尊敬的马云先生您好！我是EMBA16级的梁栋锐，非常荣幸能听到您刚才给我们精彩的分享。您的很多在人生创业战略还有企业管理方面的很多观点，都影响了我们，包括你开创了电商的先河，前段时间你的演讲，电商已死，中国面临新的环境，您的很多思想归根到底是你的创新的企业家精神的一种体现。美国也是80年代企业家精神，也是推动了美国经济的转型。目前在中国这么一个阶段也面临经济的转型，民营企业也面临很多困境，我想请马云先生给我们分享一下企业家精神在中国的经济和商业管理实践中面临的一些问题和您的建议。</p>
<p>马云：</p>
<p>企业家精神，其实一个企业它的格局决定了未来。什么是格？你的格局决定你的结局，格在我看来，就是时间度，你必须从三十年以后看今天。二十年以后看今天，这叫格，时间之格。局就是从世界来看中国，在中国看自己，有这样的局，你才有可能看得更远一点。其实像我们这样的人，以前学会了爬在山坡上看问题，后来我见了无数的人，他们原来爬到山峰上看问题，我们再爬，爬到珠峰上看看，其实你到了珠峰什么都看不见，我们天天担心的是怎么活下来。大家就没想过做阿里这样的公司大了以后，风险比公司更大。有多少人跟那些爬珠峰的人聊过？山脚下的人，你跑上七千米以后，完全是两回事情，你哪有心情看风景？哪有时间跟边上聊，到了七千米以后，你一步踩错就没了，你身上吃的东西和喝的东西超过分量以后就下不来了。</p>
</blockquote>
<p>不要说救别人，你连自己都无法救。他太危险了在上面，到上面空气都没了。我们到今天为止，见各种人以后，只在无人机上看世界。看清以后，一种路子是跟自己讲，我自己赚把钱跑，反正我开了这条线。日本大海啸以后，站在那个高度可以看到有一条路，很多人看不见只能这样跑，如果你从上面判断下来，一定会这样，你可能多了一条路。但问题是你看见的，你要不要跟社会分享，并且建立这条通道，使得房子将来出现问题的时候，社会更多人逃出来，这就是企业家精神，你必须带着使命感，你必须看到以后跟社会分享。不管别人骂你是疯子，是骗子，是十恶不赦的破坏者，你都要讲出来。这个是企业家精神，并且一个人干不了，你必须把团队合在一起，影响更多的人。商业是最大的公益，我们学校很多人看不起商人，商人也看不起学校。我们商业和学校之间的路是多么远？我是学校出来的，教了六年书，我也看不起商人，干了以后，商人是亲了不起的群体。知识很厉害，要变成财富，这个距离是多么的遥远！但是这个如何把它们结合在一起？</p>
<p>什么是商业？商业有三个要素，我个人理解，结果导向，第二，效率导向，第三公平导向。商业社会第一必须有结果，计划做的很好，教授们不好意思，教授们课上完，工作就结束了。我们战略做完还没开始呢，没有业绩我们就死了。教授不怕学生跑光的，我们员工跑光了，完了。教授可能我少了一个黑板，少了一个电脑，我们什么都少了，我们必须要有结果。政府必须要有结果，学校要有结果，培养人才。公司大家在座有多少是老板？有多少碰到过下个月工资开不了？你算一算还有两个月工资，有多少人碰到过？你就知道下个月的工资在哪，怎么办？这是你知道没有结果一定得死。第二什么叫效率导向？别人干这个事情十块钱，我是否八块钱能干什么？我是否两块钱能干什么？政府同样要有结果，政府效率没有。我们的企业如果人家干这个事情五块钱，你干这个事情六块钱，你是必死无疑。人家干这个事情十个人，你干这个事情八个人，你就赢了。没有效率，谈什么企业！</p>
<p>企业没办法逼你必须跟我合作，不是强买强卖，你不跟我合作，怎么怎么，没用，还得公平。这三个要素，所以企业家精神是百折不挠，你要有强大的心力，千万不要误判，智商低，情商低，你引不到优秀的人才，引到优秀的人才以后，他给你带来的无数的期盼的价值点，我边上有一帮阿里的人，这些人贡献想法。你是一个情商低的人，你是一个暴君，没有人说话，企业家精神涵盖了很多。企业家精神第一点，让企业更透明，更有效，让企业有钱赚，让消费者有钱赚，互联网企业必须要有很强的企业家精神，你明知道未来三十年很多行业要变革。你要看的，如果这是你能够帮助捐五块钱，今天的金融危机和经济危机所造成的伤害不亚于任何一次局部战争，这个企业家精神，不是你多累，没有人逼你，世界没有马云照转，没有阿里巴巴还有其他公司。你说很累，so what，你干，你有福气。</p>
<p>学生：</p>
<p>马老师您好，我想提一个蚂蚁金服的问题，我之前在中金公司工作，这几年我们公司有些同事加入蚂蚁金服，偶尔会有一些交流，蚂蚁金服跟传统企业合作的时候，自己强调搭建一个金融平台，蚂蚁金服的角色更像是直接参与竞争的竞争者，比如他控股了天弘基金，我的问题是你如何看待做合作者和搭建平台这种之间的关系？直接参与金融行业的竞争，是搭建这个平台之间必须要经历的过程吗？如果是的话，这个过程会有多长？</p>
<p>马云：</p>
<p>蚂蚁金服现在增长很快，但是蚂蚁金服自己称要搭建一个平台，但是我们进入了很多金融的直接行业，开始对金融行业开始冲击。这是好问题，首先蚂蚁金服不是做金融，昨天我刚刚赶到北京之前一个小时，跟蚂蚁金服交流了我的看法。未来的5+1的新，第一新零售，不是没有电子商务，而是电子商务跟线下零售和物流必须结合为一体，创造新零售，线上线下必须融为一体。第二会出现新制造，由于数据时代，IOT的发展，制造业会发生天翻地覆的变化，如果制造业不变，十年以后制造业会哇哇大叫。第三是新金融，传统的金融是解决20%的大客户、大企业，赚了80%的利润，由于出现了创新型社会，特别是普惠金融，所有的人，我认为80%的年轻人，80%的中小企业，80%的小企业和民营企业都有权利获得金融支持。金融是一个公平的人权，每个人都有这个权利。未来新金融就是服务80%昨天没被服务的人，赚20%的钱，未来就是八二理论。会出现新技术，未来二十年什么样的技术最重要，以及新能源，原来是石油，今天可能是数据，中间我们称之为新文化，文化也会发生很大的变化。文化这个词还是蛮有意思，中国人说我搞文化的，老外这个词很难翻译的，文化，你搞图书馆的，博物馆的，不是，我们不愿意把文化称为娱乐，就是娱乐嘛。唱歌者是艺术家，跳舞的，每个行业都有艺术家，这五个新的变革，肯定在十年以内各行各业会发生。这个发生以后，不是我们推动的，而是社会推动以后，必须适应未来的社会。不是互联网公司破坏了传统行业，而是互联网公司把年轻人知道了未来的船的方向在这，死死拽住，他做的很好，你在那儿哇哇大叫，是改变自己，适应未来。世界上最没用的就是抱怨，成功者永远在找方向，失败者永远在找借口，都是别人害的，很多人还活的挺好，那是你自己惹的。新金融和新思想，我们觉得要建立21世纪的普惠金融，但是我们今天金融的监管很麻烦，所以我们申请牌照不是为了赚更多的钱，我个人觉得拿牌照是拥抱监管，我们获得一个银行牌照，我们就告诉银监会，我们在做什么，他们担心什么，只有这样，被监管也是一种幸福。监管部门同样面临挑战，我们必须让监管部门共同努力，制造出未来的监管。我们的脚42码，绝大部分的公司35码，要么公平，35码，不行，你是28码，你是民营企业，我们人人都想创新，但是其实我们没有给创新更多的机会。创新怎么去跟部门沟通？</p>
<p>我讲一个具体的例子，结束今天这个话。我去了美国的篮球协会，世界篮球协会，在洛桑，最早的篮球，美国人想了一个办法，做一个篮子，比赛的时候球进去以后，马上有人拿个梯子过来，把球弄下来，继续比赛。他这个蓝筐就是一个篮子，就是比赛将近18年，突然有一个人弄一个底不挺好嘛，把下面那个筐给剪掉，大家很高兴，第一个提出反对的是搬梯子的人说我没就业了，那不行。后来发现速度快了，这个底拿掉以后，原来搞了半天，几比几，现在几十比几，全乱套了，这就是监管的制度要发生很大的变革。任何一个变革都会出现巨大的变革，蚂蚁金服为什么做这个事情？我们要拥抱监管，才会要申请各种牌照。不是我们对这个业务多感兴趣，同时对这块业务只有摸透以后，我们才能跟其他金融机构进行分享，我们是怎么做的。就像我们的零售行业，我们现在在中国的零售占了10%以上，90%的零售都是线下的，把他们摧毁不是我们的目的，摧毁传统零售，我们不能破坏性创新。中国一直以来是推翻式创新，要建设性创新。先建一个新的，告诉大家这个挺好，你要不要改一改？请大家搬过来，我们再共同参加，如果破坏性创新是要死的。中国现在的金融体系，我觉得没有中国过去三十年金融的努力，中国经济不可能有这么好的发展。但是同样要看到未来金融的发展，如果我们不变革，我们80%的人没有机会，我们变革的不是我们冲击的金融，我们变革的，我想我引以为傲的是过去支付宝十多年的努力，终于让金融机构意识到我必须改革自己的服务能力。他们的服务会越来越好，他们的技术会越来越好，他们的努力也越来越大，他们觉得背后有人追着他们的时候，才会用市场机制。这是我们要做到的，而且我们乐此不疲。我们并不是看好了你这个金融、抱歉，中国不缺一家保险公司，中国不缺一家银行，多一家银行少一家银行没有区别，但是中国需要一种新型的迎接未来21世纪金融的体系，这是蚂蚁金服希望做的事情，为此我们会有很多阻力，但是我还是相信马车不会跑赢汽车，最后汽车还是会跑赢马车。</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;转载&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;10月20日，马云走进清华EMBA课堂，发表了题为“企业家精神与未来”的主题演讲。&lt;/p&gt;
    
    </summary>
    
    
      <category term="情商" scheme="https://soarkey.github.io/tags/%E6%83%85%E5%95%86/"/>
    
      <category term="智商" scheme="https://soarkey.github.io/tags/%E6%99%BA%E5%95%86/"/>
    
  </entry>
  
  <entry>
    <title>灰色预测模型解题步骤</title>
    <link href="https://soarkey.github.io/2017/03/16/%E7%81%B0%E8%89%B2%E9%A2%84%E6%B5%8B%E6%A8%A1%E5%9E%8B%E8%A7%A3%E9%A2%98%E6%AD%A5%E9%AA%A4/"/>
    <id>https://soarkey.github.io/2017/03/16/灰色预测模型解题步骤/</id>
    <published>2017-03-16T00:00:00.000Z</published>
    <updated>2017-03-17T13:27:27.950Z</updated>
    
    <content type="html"><![CDATA[<h1 id="灰色模型简介"><a href="#灰色模型简介" class="headerlink" title="灰色模型简介"></a>灰色模型简介</h1><p>白色系统是指系统内部特征是完全已知的；黑色系统是指系统内部信息完全未知的；<br>而灰色系统是介于白色系统和黑色系统之间的一种系统，灰色系统其内部一部分信息已知，另一部分信息未知或不确定。<br><a id="more"></a></p>
<p>灰色预测，是指对系统行为特征值的发展变化进行的预测，对既含有已知信息又含有不确定信息的系统进行的预测，也就是对在一定范围内变化的、与时间序列有关的灰过程进行预测。尽管灰过程中所显示的现象是随机的、杂乱无章的，但毕竟是有序的、有界的，因此得到的数据集合具备潜在的规律。灰色预测是利用这种规律建立灰色模型对灰色系统进行预测。</p>
<p>目前使用最广泛的灰色预测模型就是关于数列预测的一个变量、一阶微分的GM(1,1)模型。它是基于随机的原始时间序列，经按时间累加后所形成的新的时间序列呈现的规律可用一阶线性微分方程的解来逼近。经证明，经一阶线性微分方程的解逼近所揭示的原始时间序列呈指数变化规律。因此，当原始时间序列隐含着指数变化规律时，灰色模型GM(1,1)的预测是非常成功的。</p>
<h1 id="适用情景"><a href="#适用情景" class="headerlink" title="适用情景"></a>适用情景</h1><p>灰色模型适用于适合数据较少的情况（超过三组就行）,一般是在其他预测方法用不了时采用的方法。</p>
<h1 id="GM-1-1-模型"><a href="#GM-1-1-模型" class="headerlink" title="GM(1,1)模型"></a>GM(1,1)模型</h1><p>设有原始序列$x^{(0)}=(x^{(0)}(1),x^{(0)}(2),…,x^{(0)}(n)$,n为数据个数。<br>则根据$x^{(0)}$数据建立GM（1,1）模型来实现预测功能步骤如下:</p>
<h2 id="1-一次累加生成序列"><a href="#1-一次累加生成序列" class="headerlink" title="1.一次累加生成序列"></a>1.一次累加生成序列</h2><p>原始数据一次累加以便弱化随机序列的波动性和随机性，得到新数据序列:<br>$$<br>    x^{(1)}=(x^{(1)}(1),x^{(1)}(2),…,x^{(1)}(n)) \\<br>            =(x^{(0)}(1),x^{(0)}(1)+x^{(0)}(2),…,x^{(0)}(1)+x^{(0)}(2)+…+x^{(0)}(n))<br>$$<br>其中,$x^{(1)}(k)$中各数据表示对应前n项数据的累加。<br>$$x^{(1)}(k)=\sum_{i=1}^{k} x^{(0)}(i), k=1,2,…,n$$</p>
<h2 id="2-建立灰微分方程与白化微分方程"><a href="#2-建立灰微分方程与白化微分方程" class="headerlink" title="2.建立灰微分方程与白化微分方程"></a>2.建立灰微分方程与白化微分方程</h2><p>建立灰微分方程：<br>$$<br>    x^{(0)}(k)+az^{(k)}=b, k=2,3,…,n<br>$$<br>对应的白化微分方程为：<br>$$<br>    \frac{dx^{(1)}}{dt}+ax^{(t)}=b<br>$$</p>
<p>记$u=\begin{bmatrix}a ， b  \end{bmatrix}^{T}$</p>
<p>其中,a、b为待定系数,分别称为发展灰数和内生控制灰数（或称发展系数和灰色作用量）,a的有效区间是（-2,2）,只要求出参数a、b,就能求出$x^{(1)}(k)$,进而求出$x^{(1)}(k+1)$的未来预测值。</p>
<h2 id="3-对累加生成数据做均值生成序列B与常数项向量Y"><a href="#3-对累加生成数据做均值生成序列B与常数项向量Y" class="headerlink" title="3.对累加生成数据做均值生成序列B与常数项向量Y"></a>3.对累加生成数据做均值生成序列B与常数项向量Y</h2><p>$$  B=\begin{bmatrix}<br>        -\frac{1}{2}(x^{(1)}(1)+x^{(1)}(2)) &amp; 1 \\<br>        -\frac{1}{2}(x^{(1)}(2)+x^{(1)}(3)) &amp; 1  \\<br>        … &amp; …  \\<br>        -\frac{1}{2}(x^{(1)}(n-1)+x^{(1)}(n)) &amp; 1  \\<br>        \end{bmatrix},<br>    Y=\begin{bmatrix}<br>            x^{(0)}(2) ， x^{(0)}(3) ， … ， x^{(0)}(n)<br>      \end{bmatrix}^{T}<br>$$</p>
<h2 id="4-用最小二乘法求解灰参数u"><a href="#4-用最小二乘法求解灰参数u" class="headerlink" title="4.用最小二乘法求解灰参数u"></a>4.用最小二乘法求解灰参数u</h2><p>由最小二乘法,求使得关于u的函数$J(u)=(Y-Bu)^T(Y-Bu)$达到最小值的u的估计值为<br>$$<br>    \hat{u}=\begin{bmatrix}<br>                \hat{a} , \hat{b}<br>            \end{bmatrix}^T<br>            =(B^{T}B)^{-1}B^{T}Y<br>$$<br><a href="https://zh.wikipedia.org/wiki/%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E6%B3%95" target="_blank" rel="external">最小二乘法——维基百科</a></p>
<h2 id="5-求解白化微分方程"><a href="#5-求解白化微分方程" class="headerlink" title="5.求解白化微分方程"></a>5.求解白化微分方程</h2><p>将灰参数$\hat{u}$带入微分方程$\frac{dx^{(1)}}{dt}+ax^{(t)}=b$中求解,得<br>$$<br>    \hat{x}^{(1)}(k+1)=\begin{pmatrix}x^{(0)}(1)-\frac{\hat{b}}{\hat{a}}\end{pmatrix}e^{-\hat{a}k}+\frac{\hat{b}}{\hat{a}},k=0,1,…,n-1,…<br>$$<br>即为GM(1,1)模型。</p>
<!--
待补充:
# 解题步骤
## 1.数据的检验与处理
首先，为了保证建模方法的可行性，需要对已知数据列作必要的检验处理。设参考数据为$x^{(1)}=(x^{(1)}(1),x^{(1)}(2),...,x^{(1)}(n))$,计算序列的级比:
$$\lambda(k)=\frac{x^{(0)}(k-1)}{x^{(0)}(k)},k=2,3,...,n$$

如果所有的级比都落在可容覆盖$$内

-->
<h1 id="例题解析"><a href="#例题解析" class="headerlink" title="例题解析"></a>例题解析</h1><p>北方某城市1986-1992年道理交通噪声平均声级数据见下表</p>
<blockquote>
<p>表5.1  城市交通噪声数据/dB(A)</p>
</blockquote>
<table>
<thead>
<tr>
<th>序号</th>
<th>年份</th>
<th>$L_{eq}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1986</td>
<td>71.1</td>
</tr>
<tr>
<td>2</td>
<td>1987</td>
<td>72.4</td>
</tr>
<tr>
<td>3</td>
<td>1988</td>
<td>72.4</td>
</tr>
<tr>
<td>4</td>
<td>1989</td>
<td>72.1</td>
</tr>
<tr>
<td>5</td>
<td>1990</td>
<td>71.4</td>
</tr>
<tr>
<td>6</td>
<td>1991</td>
<td>72.0</td>
</tr>
<tr>
<td>7</td>
<td>1992</td>
<td>71.6</td>
</tr>
</tbody>
</table>
<h2 id="1-级比检验"><a href="#1-级比检验" class="headerlink" title="1.级比检验"></a>1.级比检验</h2><p>建立交通噪声平均声级数据时间序列如下:<br>$x^{(1)}=(x^{(1)}(1),x^{(1)}(2),…,x^{(1)}(n))=(71.1,72.4,72.4,72.1,71.4,72.0,71.6)$<br>(1).求级比$\lambda(k)$,有<br>$$\lambda(k)=\frac{x^{(0)}(k-1)}{x^{(0)}(k)},$$<br>$$\lambda=(\lambda(2),\lambda(3),…,\lambda(7))=(0.982,1,1.0042,1.0098,0.9917,1.0056)$$<br>(2).级比判断<br>由于所有的$\lambda(k)\in[0.982,1.0098],k=2,…,7$,故可以用$x^{(0)}$作令人满意的GM(1,1)建模。</p>
<h2 id="2-GM-1-1-建模"><a href="#2-GM-1-1-建模" class="headerlink" title="2.GM(1,1)建模"></a>2.GM(1,1)建模</h2><p>(1).对原始数据$x^{(1)}$作一次累加，得<br>$$x^{(1)}=(71.1,143.5,215.9,288,359.4,431.4,503)$$<br>(2).构造数据矩阵B及数据向量Y,有<br>$$<br>    B=\begin{bmatrix}<br>        -\frac{1}{2}(x^{(1)}(1)+x^{(1)}(2)) &amp; 1 \\<br>        -\frac{1}{2}(x^{(1)}(2)+x^{(1)}(3)) &amp; 1  \\<br>        … &amp; …  \\<br>        -\frac{1}{2}(x^{(1)}(n-1)+x^{(1)}(7)) &amp; 1  \\<br>        \end{bmatrix},<br>    Y=\begin{bmatrix}<br>        x^{(0)}(2) \\<br>        x^{(0)}(3) \\<br>        … \\<br>        x^{(0)}(7)<br>      \end{bmatrix}<br>$$<br>(3)计算:<br>$$\hat{u}=\begin{bmatrix}\hat{a} \ \hat{b}\end{bmatrix}=(B^{T}B)^{-1}B^{T}Y=\begin{bmatrix}0.0023 \ 72.6573\end{bmatrix}$$,<br>于是得到$\hat{a}=0.0023,\hat{b}=72.6573$。<br>(4).建立模型:<br>$$\frac{dx^{(1)}}{dt}+\hat{a}x^{(t)}=\hat{b}$$<br>求解，得<br>$$\hat{x}^{(1)}(k+1)=\begin{pmatrix}x^{(0)}(1)-\frac{\hat{b}}{\hat{a}}\end{pmatrix}e^{-\hat{a}k}+\frac{\hat{b}}{\hat{a}}=-30929e^{-0.0023k}+31000 $$<br>(5).求生成序列预测值$\hat{x}^{(1)}(k+1)$及模型还原值$\hat{x}^{(0)}(k+1)$，令$k=1,2,3,4,5,6$,由(4)中解得的函数可算得$\hat{x}^{(1)}$,其中取$\hat{x}^{(1)}(1)=\hat{x}^{(0)}(1)=x^{(0)}(1)=71.1$,由$\hat{x}^{(0)}(k+1)=\hat{x}^{(1)}(k+1)-x^{(0)}(k)$,取$k=1,2,3,4,5,6$,得<br>$$\hat{x}^{(0)}=(\hat{x}^{(0)}(1),\hat{x}^{(0)}(2),…,\hat{x}^{(0)}(7))=(71.1,72.4,72.2,72.1,71.9,71.7,71.6) $$</p>
<h2 id="3-模型检验"><a href="#3-模型检验" class="headerlink" title="3.模型检验"></a>3.模型检验</h2><p>模型的各种检验指标值的计算结果见下表:</p>
<blockquote>
<p>表5.3.1 GM(1,1)模型检验表</p>
</blockquote>
<table>
<thead>
<tr>
<th>序号</th>
<th>年份</th>
<th>原始值</th>
<th>预测值</th>
<th>残差</th>
<th>相对误差</th>
<th>级比误差</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1986</td>
<td>71.1</td>
<td>71.1</td>
<td>0</td>
<td>0</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>1987</td>
<td>72.4</td>
<td>72.4057</td>
<td>-0.0057</td>
<td>0.01%</td>
<td>0.0203</td>
</tr>
<tr>
<td>3</td>
<td>1988</td>
<td>72.4</td>
<td>72.2362</td>
<td>0.1638</td>
<td>0.23%</td>
<td>0.0023</td>
</tr>
<tr>
<td>4</td>
<td>1989</td>
<td>72.1</td>
<td>72.0671</td>
<td>0.0329</td>
<td>0.05%</td>
<td>-0.0018</td>
</tr>
<tr>
<td>5</td>
<td>1990</td>
<td>71.4</td>
<td>71.8984</td>
<td>-0.4984</td>
<td>0.7%</td>
<td>-0.0074</td>
</tr>
<tr>
<td>6</td>
<td>1991</td>
<td>72.0</td>
<td>71.7301</td>
<td>0.2699</td>
<td>0.37%</td>
<td>0.0107</td>
</tr>
<tr>
<td>7</td>
<td>1992</td>
<td>71.6</td>
<td>71.5622</td>
<td>0.0378</td>
<td>0.05%</td>
<td>-0.0032</td>
</tr>
</tbody>
</table>
<p>经验证，该模型的精度较高，可进行预测和预报。</p>
<h2 id="4-附MATLAB代码"><a href="#4-附MATLAB代码" class="headerlink" title="4.附MATLAB代码"></a>4.附MATLAB代码</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">% 灰色模型</span></div><div class="line">clear;</div><div class="line">close all;</div><div class="line">clc;</div><div class="line"><span class="comment">% 输入数据</span></div><div class="line">x0=[<span class="number">71.1</span> <span class="number">72.4</span> <span class="number">72.4</span> <span class="number">72.1</span> <span class="number">71.4</span> <span class="number">72.0</span> <span class="number">71.6</span>]';  <span class="comment">% 注意为列向量</span></div><div class="line">n=<span class="built_in">length</span>(x0);</div><div class="line">lamda=x0(<span class="number">1</span>:n<span class="number">-1</span>)./x0(<span class="number">2</span>:n)    <span class="comment">% 计算级比</span></div><div class="line">range=minmax(lamda')        <span class="comment">% 计算级比的范围</span></div><div class="line">x1=cumsum(x0)               <span class="comment">% 累加运算</span></div><div class="line">B=[<span class="number">-0.5</span>*(x1(<span class="number">1</span>:n<span class="number">-1</span>)+x1(<span class="number">2</span>:n)),ones(n<span class="number">-1</span>,<span class="number">1</span>)];</div><div class="line">Y=x0(<span class="number">2</span>:n);</div><div class="line">u=B\Y;                      <span class="comment">% 拟合参数u(1)=a,u(2)=b</span></div><div class="line">syms x(t)</div><div class="line">x=dsolve(diff(x)+u(<span class="number">1</span>)*x == u(<span class="number">2</span>),x(<span class="number">0</span>) == x0(<span class="number">1</span>)); <span class="comment">% 求微分方程的特解 符号解</span></div><div class="line">xt=vpa(x,<span class="number">6</span>)                <span class="comment">% 以小数格式显示微分方程的解</span></div><div class="line">yuce1=subs(x,t,[<span class="number">0</span>:n<span class="number">-1</span>]);   <span class="comment">% 求已知数据的预测值</span></div><div class="line">yuce2=double(yuce1);       <span class="comment">% 符号数转为数值类型，否则无法做差分运算</span></div><div class="line"></div><div class="line">yuce=[x0(<span class="number">1</span>),diff(yuce2)]   <span class="comment">% 差分运算,还原数据</span></div><div class="line">epsilon=x0'-yuce           <span class="comment">% 计算残差</span></div><div class="line">delta=<span class="built_in">abs</span>(epsilon./x0')    <span class="comment">% 计算相对误差</span></div><div class="line">rho=<span class="number">1</span>-(<span class="number">1</span><span class="number">-0.5</span>*u(<span class="number">1</span>))/(<span class="number">1</span>+<span class="number">0.5</span>*u(<span class="number">1</span>))*lamda'   <span class="comment">% 计算级比偏差值，u(1)=a</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;灰色模型简介&quot;&gt;&lt;a href=&quot;#灰色模型简介&quot; class=&quot;headerlink&quot; title=&quot;灰色模型简介&quot;&gt;&lt;/a&gt;灰色模型简介&lt;/h1&gt;&lt;p&gt;白色系统是指系统内部特征是完全已知的；黑色系统是指系统内部信息完全未知的；&lt;br&gt;而灰色系统是介于白色系统和黑色系统之间的一种系统，灰色系统其内部一部分信息已知，另一部分信息未知或不确定。&lt;br&gt;
    
    </summary>
    
      <category term="灰色模型" scheme="https://soarkey.github.io/categories/%E7%81%B0%E8%89%B2%E6%A8%A1%E5%9E%8B/"/>
    
    
      <category term="灰色预测" scheme="https://soarkey.github.io/tags/%E7%81%B0%E8%89%B2%E9%A2%84%E6%B5%8B/"/>
    
      <category term="数学模型" scheme="https://soarkey.github.io/tags/%E6%95%B0%E5%AD%A6%E6%A8%A1%E5%9E%8B/"/>
    
  </entry>
  
  <entry>
    <title>mysql、java数据类型的对应关系</title>
    <link href="https://soarkey.github.io/2017/03/11/mysql%E4%B8%8Ejava%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%AF%B9%E5%BA%94/"/>
    <id>https://soarkey.github.io/2017/03/11/mysql与java的数据类型对应/</id>
    <published>2017-03-11T00:00:00.000Z</published>
    <updated>2017-03-12T05:35:21.762Z</updated>
    
    <content type="html"><![CDATA[<p>mysql数据类型与java数据类型的对应关系：<br><a id="more"></a></p>
<table>
<thead>
<tr>
<th>类型名称</th>
<th>显示长度</th>
<th>数据库类型</th>
<th>JAVA类型</th>
<th>JDBC类型索引(int)</th>
</tr>
</thead>
<tbody>
<tr>
<td>VARCHAR</td>
<td>L+N</td>
<td>VARCHAR</td>
<td>java.lang.String</td>
<td>12</td>
</tr>
<tr>
<td>CHAR</td>
<td>N</td>
<td>CHAR</td>
<td>java.lang.String</td>
<td>1</td>
</tr>
<tr>
<td>BLOB</td>
<td>L+N</td>
<td>BLOB</td>
<td>java.lang.byte[]</td>
<td>-4</td>
</tr>
<tr>
<td>TEXT</td>
<td>65535</td>
<td>VARCHAR</td>
<td>java.lang.String</td>
<td>-1</td>
</tr>
<tr>
<td>INTEGER</td>
<td>4</td>
<td>INTEGER UNSIGNED</td>
<td>java.lang.Long</td>
<td>4</td>
</tr>
<tr>
<td>TINYINT</td>
<td>3</td>
<td>TINYINT UNSIGNED</td>
<td>java.lang.Integer</td>
<td>-6</td>
</tr>
<tr>
<td>SMALLINT</td>
<td>5</td>
<td>SMALLINT UNSIGNED</td>
<td>java.lang.Integer</td>
<td>5</td>
</tr>
<tr>
<td>MEDIUMINT</td>
<td>8</td>
<td>MEDIUMINT UNSIGNED</td>
<td>java.lang.Integer</td>
<td>4</td>
</tr>
<tr>
<td>BIT</td>
<td>1</td>
<td>BIT</td>
<td>java.lang.Boolean</td>
<td>-7</td>
</tr>
<tr>
<td>BIGINT</td>
<td>20</td>
<td>BIGINT UNSIGNED</td>
<td>java.math.BigInteger</td>
<td>-5</td>
</tr>
<tr>
<td>FLOAT</td>
<td>4+8</td>
<td>FLOAT</td>
<td>java.lang.Float</td>
<td>7</td>
</tr>
<tr>
<td>DOUBLE</td>
<td>22</td>
<td>DOUBLE</td>
<td>java.lang.Double</td>
<td>8</td>
</tr>
<tr>
<td>DECIMAL</td>
<td>11</td>
<td>DECIMAL</td>
<td>java.math.BigDecimal</td>
<td>3</td>
</tr>
<tr>
<td>BOOLEAN</td>
<td>1</td>
<td>同TINYINT</td>
<td></td>
<td></td>
</tr>
<tr>
<td>ID</td>
<td>11</td>
<td>PK (INTEGER UNSIGNED)</td>
<td>java.lang.Long</td>
<td>4</td>
</tr>
<tr>
<td>DATE</td>
<td>10</td>
<td>DATE</td>
<td>java.sql.Date</td>
<td>91</td>
</tr>
<tr>
<td>TIME</td>
<td>8</td>
<td>TIME</td>
<td>java.sql.Time</td>
<td>92</td>
</tr>
<tr>
<td>DATETIME</td>
<td>19</td>
<td>DATETIME</td>
<td>java.sql.Timestamp</td>
<td>93</td>
</tr>
<tr>
<td>TIMESTAMP</td>
<td>19</td>
<td>TIMESTAMP</td>
<td>java.sql.Timestamp</td>
<td>93</td>
</tr>
<tr>
<td>YEAR</td>
<td>4</td>
<td>YEAR</td>
<td>java.sql.Date</td>
<td>91</td>
</tr>
</tbody>
</table>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;mysql数据类型与java数据类型的对应关系：&lt;br&gt;
    
    </summary>
    
      <category term="数据类型对应关系" scheme="https://soarkey.github.io/categories/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB/"/>
    
    
      <category term="mysql" scheme="https://soarkey.github.io/tags/mysql/"/>
    
      <category term="java" scheme="https://soarkey.github.io/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>关于Cookie技术的介绍</title>
    <link href="https://soarkey.github.io/2017/03/05/%E5%85%B3%E4%BA%8Ecookie%E7%9A%84%E4%BB%8B%E7%BB%8D/"/>
    <id>https://soarkey.github.io/2017/03/05/关于cookie的介绍/</id>
    <published>2017-03-05T00:00:00.000Z</published>
    <updated>2017-03-11T13:25:33.999Z</updated>
    
    <content type="html"><![CDATA[<p>cookie基本知识介绍<br><a id="more"></a></p>
<h1 id="一、会话技术分类"><a href="#一、会话技术分类" class="headerlink" title="一、会话技术分类"></a>一、会话技术分类</h1><p>cookie技术：会话数据保存在浏览器客户端<br>session技术：会话数据保存在服务器端</p>
<h1 id="二、cookie使用步骤"><a href="#二、cookie使用步骤" class="headerlink" title="二、cookie使用步骤"></a>二、cookie使用步骤</h1><h2 id="1-构造Cookie"><a href="#1-构造Cookie" class="headerlink" title="1.构造Cookie"></a>1.构造Cookie</h2><ul>
<li>Cookie(java.lang.String name, java.lang.String value)</li>
</ul>
<h2 id="2-设置Cookie"><a href="#2-设置Cookie" class="headerlink" title="2.设置Cookie"></a>2.设置Cookie</h2><ul>
<li><p>void setPath(java.lang.String uri)       设置有效访问途径</p>
<blockquote>
<p>有效路径指的是cookie的有效路径保存位置，浏览器在有效路径下访问服务器时就会带着cookie信息，否则不带cookie信息。</p>
</blockquote>
</li>
<li><p>void setMaxAge(int expiry)               设置Cookie有效时间,单位为秒</p>
<blockquote>
<p><strong>注意细节：</strong><br><br>正整数：保存时间长度（1*30*24*60*60)</p>
<p>负整数：实现会话cookie, cookie保存在浏览器内存，随着浏览器的关闭而清除</p>
<ul>
<li>例如:cookie.setMaxAge(-1)</li>
</ul>
<p>零：删除同名的cookie</p>
</blockquote>
</li>
<li><p>void setValue(java.lang.String newValue)   设置Cookie的值  </p>
<blockquote>
<p><strong>注意细节</strong></p>
<p>Cookie数据类型只能保存非中文字符串类型的。浏览器一般只允许存放300个Cookie，每个站点最多存放20个Cookie，每个Cookie的大小限制为4KB</p>
</blockquote>
</li>
</ul>
<h2 id="3-发送Cookie到浏览器保存"><a href="#3-发送Cookie到浏览器保存" class="headerlink" title="3.发送Cookie到浏览器保存"></a>3.发送Cookie到浏览器保存</h2><ul>
<li>void addCookie(Cookie cookie)           发送Cookie给浏览器</li>
</ul>
<h2 id="4-服务器接收Cookie"><a href="#4-服务器接收Cookie" class="headerlink" title="4.服务器接收Cookie"></a>4.服务器接收Cookie</h2><ul>
<li>Cookie[] request.getCookies                接收Cookie</li>
</ul>
<h1 id="三、Cookie的局限："><a href="#三、Cookie的局限：" class="headerlink" title="三、Cookie的局限："></a>三、Cookie的局限：</h1><p>1.Cookie只能存储字符串类型，不能保存对象</p>
<p>2.只能存储非中文数据</p>
<p>3.&nbsp;1个Cookie的容量不超过4KB</p>
<blockquote>
<p>如果要保存非字符串数据，超过4kb内容，只能使用session技术！</p>
</blockquote>
<h1 id="四、Cookie常见错误"><a href="#四、Cookie常见错误" class="headerlink" title="四、Cookie常见错误"></a>四、Cookie常见错误</h1><h2 id="1-数据类型错误"><a href="#1-数据类型错误" class="headerlink" title="1.数据类型错误"></a>1.数据类型错误</h2><blockquote>
<p><code>An invalid character [32] was present in the Cookie value</code></p>
</blockquote>
<p>错误代码:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">SimpleDateFormat simpleDateFormat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">""</span>yyyy-MM-dd HH:mm:ss<span class="string">""</span>);</div><div class="line">String nowTime = simpleDateFormat.format(<span class="keyword">new</span> java.util.Date());</div><div class="line">Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">""</span>time<span class="string">""</span>nowTime);</div><div class="line">cookie.setMaxAge(<span class="number">3600</span>);</div><div class="line">response.addCookie(cookie);</div></pre></td></tr></table></figure></p>
<p>解决方案:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">SimpleDateFormat simpleDateFormat = new SimpleDateFormat(&quot;&quot;yyyy-MM-dd HH:mm:ss&quot;&quot;);</div><div class="line">这一行代码yyyy-MM-dd和HH:mm:ss中间有个空格就会出错。</div><div class="line">如果改成这样</div><div class="line">SimpleDateFormat simpleDateFormat = new SimpleDateFormat(&quot;&quot;yyyy-MM-ddHH:mm:ss&quot;&quot;);</div><div class="line">把yyyy-MM-dd和HH:mm:ss连着写就没有错了。</div><div class="line">这是因为cookie不能存放除英文以外的数据，具有很大的局限性</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;cookie基本知识介绍&lt;br&gt;
    
    </summary>
    
      <category term="Java Web" scheme="https://soarkey.github.io/categories/Java-Web/"/>
    
    
      <category term="Cookie" scheme="https://soarkey.github.io/tags/Cookie/"/>
    
  </entry>
  
  <entry>
    <title>利用hexo搭建博客</title>
    <link href="https://soarkey.github.io/2017/02/27/%E5%88%A9%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/"/>
    <id>https://soarkey.github.io/2017/02/27/利用hexo搭建博客/</id>
    <published>2017-02-27T00:00:00.000Z</published>
    <updated>2017-08-29T12:50:26.105Z</updated>
    
    <content type="html"><![CDATA[<p>经过多天的学习与尝试，踩过不少坑，终于是把博客搭建成功了，下面我把我的博客搭建过程分享出来，希望能对你起到一定的帮助！</p>
<a id="more"></a>
<h2 id="准备阶段"><a href="#准备阶段" class="headerlink" title="准备阶段"></a>准备阶段</h2><h3 id="一、安装Node-js（必须）"><a href="#一、安装Node-js（必须）" class="headerlink" title="一、安装Node.js（必须）"></a>一、安装Node.js（必须）</h3><p>因为搭建博客所用的hexo框架是基于Node.js开发的，所以我们必须要先安装Node.js。<br> <a href="https://nodejs.org/en/" target="_blank" rel="external">Node.js官网</a></p>
<p>安装方法也比较简单，按照默认选项一项一项进行即可。</p>
<h3 id="二、安装Git（必须）"><a href="#二、安装Git（必须）" class="headerlink" title="二、安装Git（必须）"></a>二、安装Git（必须）</h3><p>Git的作用就是把本地仓库的内容提交到github网站上或者把github上的项目克隆到本地仓库中，对后续的hexo博客部署起着决定性的作用。<br> <a href="https://git-scm.com/" target="_blank" rel="external">Git官网</a></p>
<p>由于众所周知的原因，国内访问Git比较困难，这里提供了一个国内网盘下载链接。<br> <a href="https://npm.taobao.org/mirrors/git-for-windows/2.12.0.windows.1/Git-2.12.0-64-bit.exe" target="_blank" rel="external">Git网盘下载地址</a></p>
<h3 id="三、注册Github账号（必须）"><a href="#三、注册Github账号（必须）" class="headerlink" title="三、注册Github账号（必须）"></a>三、注册Github账号（必须）</h3><p>github一个通过Git进行版本控制的软件源代码托管服务。我们的hexo博客正是搭建与此基础上，所以需要开发者先申请注册github账号，并且创立一个名为yourname.github.io的仓库（yourname为你的github账户名称）。<br>另外github上聚集了许多著名的技术界公司和顶尖开发者的开源项目，体现了技术前沿的发展趋势，是我们一个不可多得的资料库。<br><a href="https://github.com" target="_blank" rel="external">Github官网</a></p>
<h2 id="安装配置Hexo-针对windows"><a href="#安装配置Hexo-针对windows" class="headerlink" title="安装配置Hexo (针对windows)"></a>安装配置Hexo (针对windows)</h2><h4 id="一、-安装hexo"><a href="#一、-安装hexo" class="headerlink" title="一、 安装hexo"></a>一、 安装hexo</h4><p>创建一个文件夹，命名为blog（根据自己喜好命名）,在Gitbash中执行以下git命令来安装hexo。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install -g hexo-cli</div></pre></td></tr></table></figure></p>
<h4 id="二、-建立文件"><a href="#二、-建立文件" class="headerlink" title="二、 建立文件"></a>二、 建立文件</h4><p>安装完成hexo后，执行以下命令，hexo将会在指定文件夹下新建所需文件。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ hexo init &lt;folder&gt;</div><div class="line">$ <span class="built_in">cd</span> &lt;folder&gt;</div><div class="line">$ npm install</div></pre></td></tr></table></figure></p>
<p>新建完成后，指定文件夹的目录如下<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">.</div><div class="line">├── _config.yml</div><div class="line">├── package.json</div><div class="line">├── scaffolds</div><div class="line">├── <span class="built_in">source</span></div><div class="line">|   ├── _drafts</div><div class="line">|   └── _posts</div><div class="line">└── themes</div></pre></td></tr></table></figure></p>
<h4 id="三、-生成静态页面"><a href="#三、-生成静态页面" class="headerlink" title="三、 生成静态页面"></a>三、 生成静态页面</h4><p>执行以下命令，让hexo生成静态页面。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure></p>
<p>可简写为<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo g</div></pre></td></tr></table></figure></p>
<p>执行完后会在blog目录里生成public文件夹，里面存放着发布的博客内容。</p>
<h4 id="四、-在本地预览"><a href="#四、-在本地预览" class="headerlink" title="四、 在本地预览"></a>四、 在本地预览</h4><p>执行以下命令，启动hexo服务，进行本地hexo博客效果预览与调试。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure></p>
<p>可简写为<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo s</div></pre></td></tr></table></figure></p>
<p>完成后打开浏览器输入网址<a href="http://localhost:4000，" target="_blank" rel="external">http://localhost:4000，</a><br>如果正常显示hexo默认初始页面，说明之前的配置正确，<br>hexo已经在本地部署成功。</p>
<h2 id="常见hexo配置错误"><a href="#常见hexo配置错误" class="headerlink" title="常见hexo配置错误"></a>常见hexo配置错误</h2><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>至此，hexo的基本配置步骤已经完成。<br>那我们怎么挑选适合自己博客的主题、更改博客显示的信息以及书写博客呢？<br>请参考下一篇文章《yilia主题的配置与使用》</p>
<p>参考资料：<a href="https://hexo.io/zh-cn/docs" target="_blank" rel="external">Hexo中文文档</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;经过多天的学习与尝试，踩过不少坑，终于是把博客搭建成功了，下面我把我的博客搭建过程分享出来，希望能对你起到一定的帮助！&lt;/p&gt;
    
    </summary>
    
      <category term="hexo教程" scheme="https://soarkey.github.io/categories/hexo%E6%95%99%E7%A8%8B/"/>
    
      <category term="博客搭建" scheme="https://soarkey.github.io/categories/hexo%E6%95%99%E7%A8%8B/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"/>
    
    
      <category term="hexo" scheme="https://soarkey.github.io/tags/hexo/"/>
    
      <category term="blog" scheme="https://soarkey.github.io/tags/blog/"/>
    
  </entry>
  
</feed>
